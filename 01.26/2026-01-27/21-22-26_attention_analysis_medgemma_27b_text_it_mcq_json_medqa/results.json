{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true
      },
      "model": {
        "name": "google/medgemma-27b-text-it",
        "variant": "27b-text",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9,
        "safe_name": "medgemma_27b_text_it"
      },
      "prompt": {
        "_target_": "cotlab.prompts.mcq.MCQPromptStrategy",
        "name": "mcq",
        "few_shot": true,
        "output_format": "json",
        "answer_first": false,
        "contrarian": false
      },
      "dataset": {
        "_target_": "cotlab.datasets.loaders.MedQADataset",
        "name": "medqa",
        "filename": "medqa/test.jsonl",
        "split": "test"
      },
      "experiment": {
        "_target_": "cotlab.experiments.AttentionAnalysisExperiment",
        "name": "attention_analysis",
        "description": "Analyze attention patterns at critical layers",
        "all_layers": false,
        "force_eager_reload": false,
        "num_samples": 3,
        "target_layers": [
          0,
          1,
          2
        ]
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2026-01-27T21:22:26.913669"
  },
  "experiment": "attention_analysis",
  "model": "google/medgemma-27b-text-it",
  "prompt_strategy": "mcq",
  "metrics": {
    "num_samples_analyzed": 3,
    "num_layers_analyzed": 3,
    "num_heads": 32,
    "overall_mean_entropy": 2.577346387836668,
    "most_focused_layer": 1,
    "most_focused_entropy": 1.8790982862313588
  },
  "raw_outputs": [
    {
      "layer": 0,
      "mean_entropy": 3.7322184244791665,
      "std_entropy": 0.07427313586881862,
      "mean_per_head": [
        4.854166666666667,
        5.447916666666667,
        2.6614583333333335,
        5.604166666666667,
        3.8229166666666665,
        4.770833333333333,
        0.09114583333333333,
        4.833333333333333,
        1.6458333333333333,
        4.5625,
        3.1822916666666665,
        2.296875,
        4.75,
        0.828125,
        5.145833333333333,
        5.729166666666667,
        2.5104166666666665,
        4.21875,
        5.177083333333333,
        2.9895833333333335,
        4.114583333333333,
        4.25,
        4.697916666666667,
        4.265625,
        4.677083333333333,
        5.135416666666667,
        3.9635416666666665,
        4.614583333333333,
        2.046875,
        4.625,
        1.2213541666666667,
        0.6966145833333334
      ],
      "std_per_head": [
        0.14052851628366708,
        0.01473139127471974,
        0.07795119555779044,
        0.07795119555779044,
        0.24250930680880867,
        0.28105703256733416,
        0.0017977475613911557,
        0.2411632688081297,
        0.24476396119810795,
        0.0919975090242484,
        0.24617296454367654,
        0.12170126505779086,
        0.38611985401772164,
        0.022326078384742508,
        0.18102236663523713,
        0.14950729265007628,
        0.4274007966443467,
        0.10206207261596575,
        0.3520155260149125,
        0.051559869461519095,
        0.28678958120700426,
        0.15309310892394862,
        0.11505584392903397,
        0.7163683366467282,
        0.11505584392903397,
        0.16601434844280444,
        0.07690012010538229,
        0.01473139127471974,
        0.03375385780420761,
        0.11121956512532616,
        0.02655739329996242,
        0.0018414239093399675
      ],
      "top_tokens": [
        {
          "token": ".",
          "count": 3
        },
        {
          "token": ",",
          "count": 3
        },
        {
          "token": " of",
          "count": 3
        }
      ]
    },
    {
      "layer": 1,
      "mean_entropy": 1.8790982862313588,
      "std_entropy": 0.33352529087427735,
      "mean_per_head": [
        0.5875651041666666,
        1.953125,
        0.0015764236450195312,
        0.3269856770833333,
        0.10249837239583333,
        0.23347981770833334,
        3.7395833333333335,
        2.0989583333333335,
        0.19399007161458334,
        1.12060546875,
        4.03125,
        4.25,
        0.0004793802897135417,
        5.802083333333333,
        1.8268229166666667,
        2.4322916666666665,
        1.9609375,
        0.8190104166666666,
        1.8802083333333333,
        2.2786458333333335,
        2.0,
        1.3715006510416667,
        0.14461263020833334,
        0.4495442708333333,
        4.6875,
        4.25,
        1.5416666666666667,
        0.068359375,
        2.4609375,
        1.7981770833333333,
        3.328125,
        2.390625
      ],
      "std_per_head": [
        0.7285140250298934,
        0.6648738915513729,
        0.0021007467114151864,
        0.22964600803161306,
        0.1067964941683229,
        0.2355104141596422,
        0.6380580346297314,
        0.3388820404305736,
        0.1535209131772541,
        1.0842021734789509,
        0.04419417382415922,
        0.02551551815399144,
        6.682679923233496e-05,
        0.14052851628366708,
        0.8973404382931711,
        0.6118849661542238,
        0.4114748150707404,
        0.4140174569315855,
        0.5909106084867847,
        0.7114762534346377,
        1.0068935571432895,
        0.9861097507437575,
        0.11330410664631557,
        0.31547889811132745,
        0.39610736128815716,
        0.13258252147247765,
        0.09930039565071677,
        0.019689301907867142,
        0.6283439191471234,
        0.69052905552127,
        0.0919975090242484,
        0.03375385780420761
      ],
      "top_tokens": [
        {
          "token": " ",
          "count": 4
        },
        {
          "token": "<bos>",
          "count": 2
        },
        {
          "token": ".",
          "count": 1
        },
        {
          "token": " answer",
          "count": 1
        },
        {
          "token": " a",
          "count": 1
        }
      ]
    },
    {
      "layer": 2,
      "mean_entropy": 2.120722452799479,
      "std_entropy": 0.5482078061419582,
      "mean_per_head": [
        1.8567708333333333,
        2.1536458333333335,
        1.6901041666666667,
        1.3522135416666667,
        0.16015625,
        2.578125,
        1.8802083333333333,
        0.5804036458333334,
        4.447916666666667,
        2.3020833333333335,
        4.791666666666667,
        4.229166666666667,
        1.7786458333333333,
        0.8111979166666666,
        1.546875,
        2.2317708333333335,
        2.3333333333333335,
        1.8723958333333333,
        2.5416666666666665,
        3.390625,
        0.71826171875,
        0.6295572916666666,
        2.1432291666666665,
        3.8333333333333335,
        2.2395833333333335,
        1.29296875,
        1.3854166666666667,
        1.2766927083333333,
        2.1822916666666665,
        2.3723958333333335,
        2.1041666666666665,
        3.15625
      ],
      "std_per_head": [
        0.9173692265075473,
        0.8464543209971359,
        0.8202339578801418,
        0.9084814668308248,
        0.02279110815652903,
        0.3544729068161157,
        0.49284155175765054,
        0.46996528479244903,
        0.05311478659992484,
        0.8699943626094495,
        0.06421264586426018,
        0.2315219871968007,
        0.7019183318720601,
        0.7829933889820975,
        1.1042649327342904,
        0.5256418653986021,
        0.6258241094526658,
        0.6444352306423474,
        0.7405363577990092,
        0.41122751964899756,
        0.4474708053186809,
        0.3845568164019884,
        0.7268657894467557,
        0.3473610833444389,
        0.06546773484362778,
        1.2291266655743995,
        0.9616112419036893,
        0.8117740354862738,
        0.7127618914398335,
        0.6131803371505445,
        0.8848343673472956,
        0.39795211447693885
      ],
      "top_tokens": [
        {
          "token": ".",
          "count": 2
        },
        {
          "token": " \"",
          "count": 2
        },
        {
          "token": "'",
          "count": 2
        },
        {
          "token": "\",",
          "count": 1
        },
        {
          "token": "<bos>",
          "count": 1
        }
      ]
    }
  ],
  "num_samples": 0,
  "samples": [],
  "end_time": "2026-01-27T21:22:53.071552",
  "duration_seconds": 26.157884
}