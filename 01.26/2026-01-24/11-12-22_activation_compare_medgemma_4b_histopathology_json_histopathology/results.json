{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true,
        "load_in_4bit": true,
        "bnb_4bit_quant_type": "nf4",
        "bnb_4bit_compute_dtype": "bfloat16",
        "bnb_4bit_use_double_quant": true
      },
      "model": {
        "name": "google/medgemma-4b-it",
        "variant": "4b",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9,
        "safe_name": "medgemma_4b"
      },
      "prompt": {
        "_target_": "cotlab.prompts.HistopathologyPromptStrategy",
        "name": "histopathology",
        "output_format": "json",
        "few_shot": true,
        "answer_first": false,
        "contrarian": false
      },
      "dataset": {
        "_target_": "cotlab.datasets.HistopathologyDataset",
        "name": "histopathology",
        "path": "data/histopathology.tsv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.ActivationCompareExperiment",
        "name": "activation_compare",
        "description": "Compare residual stream activations across runs",
        "num_samples": 50,
        "seed": 123,
        "pooling": "mean",
        "layers": null,
        "comparison_mode": "pairwise",
        "store_per_layer": true,
        "log_samples": false,
        "variants": [
          {
            "name": "histopathology",
            "dataset": {
              "_target_": "cotlab.datasets.HistopathologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.HistopathologyPromptStrategy"
            }
          },
          {
            "name": "radiology",
            "dataset": {
              "_target_": "cotlab.datasets.RadiologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.RadiologyPromptStrategy"
            }
          }
        ]
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2026-01-24T11:12:31.841907"
  },
  "experiment": "activation_compare",
  "model": "google/medgemma-4b-it",
  "prompt_strategy": "histopathology",
  "metrics": {
    "num_runs": 2,
    "num_layers": 34,
    "comparison_mode": "pairwise",
    "pooling": "mean",
    "pair_count": 1
  },
  "raw_outputs": [
    {
      "runs": [
        {
          "name": "histopathology",
          "dataset": "histopathology",
          "prompt": "histopathology",
          "num_samples": 50,
          "seed": 123,
          "pooling": "mean",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            120.67608642578125,
            87.46256256103516,
            128.735595703125,
            176.05953979492188,
            247.4376983642578,
            621.3429565429688,
            249.94387817382812,
            95.6740493774414,
            921.6015014648438,
            349.3076171875,
            2237.218017578125,
            2325.275390625,
            2173.08740234375,
            1424.4617919921875,
            656.1327514648438,
            1039.556884765625,
            1369.9178466796875,
            1187.438720703125,
            715.2611083984375,
            693.3474731445312,
            600.6311645507812,
            850.9345092773438,
            1157.254150390625,
            1299.98828125,
            1430.0550537109375,
            1457.814453125,
            2010.475830078125,
            2029.521240234375,
            3687.5859375,
            2198.782958984375,
            1913.3111572265625,
            3240.297119140625,
            4178.037109375,
            9836.5615234375
          ],
          "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
        },
        {
          "name": "radiology",
          "dataset": "radiology",
          "prompt": "radiology",
          "num_samples": 50,
          "seed": 123,
          "pooling": "mean",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            129.9929656982422,
            86.42566680908203,
            133.16810607910156,
            173.7003173828125,
            266.3172302246094,
            616.1973876953125,
            154.85714721679688,
            82.59380340576172,
            916.3533325195312,
            154.19580078125,
            2199.865478515625,
            2181.372802734375,
            2012.27978515625,
            1231.8548583984375,
            493.85284423828125,
            955.7750244140625,
            1226.5389404296875,
            1179.339599609375,
            680.2418212890625,
            808.727294921875,
            652.9310302734375,
            866.4191284179688,
            1132.242919921875,
            1163.84619140625,
            1320.541015625,
            1361.7088623046875,
            2143.92041015625,
            2016.10498046875,
            3617.3291015625,
            2151.811767578125,
            1897.2220458984375,
            3341.6484375,
            5784.86962890625,
            4322.95947265625
          ],
          "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
        }
      ],
      "comparisons": [
        {
          "run_a": "histopathology",
          "run_b": "radiology",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_cosine_similarity": 0.9288529588552435,
          "mean_l2_distance": 634.6174240813535,
          "layer_cosine_similarity": [
            0.9282225059982142,
            0.9959191525169834,
            0.9989262268271489,
            0.9984000922736291,
            0.9988752556964559,
            0.9991832245237999,
            0.9350670269047203,
            0.841752017660987,
            0.9991400365388262,
            0.9271440862108465,
            0.9996946101743577,
            0.9993639956686252,
            0.999427948756649,
            0.998153063565829,
            0.9834256866366923,
            0.9901043697931475,
            0.9896155061340668,
            0.9837692941305426,
            0.9557248582286899,
            0.9408800864588777,
            0.8550684599014317,
            0.9118934780572309,
            0.8439637016266306,
            0.841862009497607,
            0.746309449745429,
            0.7620685940029662,
            0.8489779713709023,
            0.8603481829681738,
            0.9561280681347594,
            0.907734487728388,
            0.8482689692714221,
            0.9629567376380388,
            0.9619814310657278,
            0.8106500153704851
          ],
          "layer_l2_distance": [
            48.36083221435547,
            7.922490119934082,
            7.515872478485107,
            10.170963287353516,
            22.46537208557129,
            25.532123565673828,
            118.60862731933594,
            51.69208908081055,
            38.48837661743164,
            214.28221130371094,
            66.37454223632812,
            164.8334197998047,
            175.68470764160156,
            208.75975036621094,
            192.5524444580078,
            163.3518829345703,
            235.48892211914062,
            213.36668395996094,
            210.5008544921875,
            282.1575927734375,
            341.19073486328125,
            360.7703552246094,
            639.9468383789062,
            705.0225219726562,
            984.9647216796875,
            976.6678466796875,
            1148.786376953125,
            1069.1170654296875,
            1084.1480712890625,
            935.56982421875,
            1049.6756591796875,
            901.3771362304688,
            2102.30908203125,
            6819.33642578125
          ]
        }
      ]
    }
  ],
  "num_samples": 2,
  "samples": [
    {
      "run_summary": {
        "name": "histopathology",
        "dataset": "histopathology",
        "prompt": "histopathology",
        "num_samples": 50,
        "seed": 123,
        "pooling": "mean",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          120.67608642578125,
          87.46256256103516,
          128.735595703125,
          176.05953979492188,
          247.4376983642578,
          621.3429565429688,
          249.94387817382812,
          95.6740493774414,
          921.6015014648438,
          349.3076171875,
          2237.218017578125,
          2325.275390625,
          2173.08740234375,
          1424.4617919921875,
          656.1327514648438,
          1039.556884765625,
          1369.9178466796875,
          1187.438720703125,
          715.2611083984375,
          693.3474731445312,
          600.6311645507812,
          850.9345092773438,
          1157.254150390625,
          1299.98828125,
          1430.0550537109375,
          1457.814453125,
          2010.475830078125,
          2029.521240234375,
          3687.5859375,
          2198.782958984375,
          1913.3111572265625,
          3240.297119140625,
          4178.037109375,
          9836.5615234375
        ],
        "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
      },
      "idx": 0,
      "timestamp": "2026-01-24T11:13:29.569101"
    },
    {
      "run_summary": {
        "name": "radiology",
        "dataset": "radiology",
        "prompt": "radiology",
        "num_samples": 50,
        "seed": 123,
        "pooling": "mean",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          129.9929656982422,
          86.42566680908203,
          133.16810607910156,
          173.7003173828125,
          266.3172302246094,
          616.1973876953125,
          154.85714721679688,
          82.59380340576172,
          916.3533325195312,
          154.19580078125,
          2199.865478515625,
          2181.372802734375,
          2012.27978515625,
          1231.8548583984375,
          493.85284423828125,
          955.7750244140625,
          1226.5389404296875,
          1179.339599609375,
          680.2418212890625,
          808.727294921875,
          652.9310302734375,
          866.4191284179688,
          1132.242919921875,
          1163.84619140625,
          1320.541015625,
          1361.7088623046875,
          2143.92041015625,
          2016.10498046875,
          3617.3291015625,
          2151.811767578125,
          1897.2220458984375,
          3341.6484375,
          5784.86962890625,
          4322.95947265625
        ],
        "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
      },
      "idx": 1,
      "timestamp": "2026-01-24T11:13:53.585817"
    }
  ],
  "end_time": "2026-01-24T11:13:53.587099",
  "duration_seconds": 81.745195
}