{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true,
        "load_in_4bit": true,
        "bnb_4bit_quant_type": "nf4",
        "bnb_4bit_compute_dtype": "bfloat16",
        "bnb_4bit_use_double_quant": true
      },
      "model": {
        "name": "google/medgemma-4b-it",
        "variant": "4b",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9,
        "safe_name": "medgemma_4b"
      },
      "prompt": {
        "_target_": "cotlab.prompts.HistopathologyPromptStrategy",
        "name": "histopathology",
        "output_format": "json",
        "few_shot": true,
        "answer_first": false,
        "contrarian": false
      },
      "dataset": {
        "_target_": "cotlab.datasets.HistopathologyDataset",
        "name": "histopathology",
        "path": "data/histopathology.tsv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.ActivationCompareExperiment",
        "name": "activation_compare",
        "description": "Compare residual stream activations across runs",
        "num_samples": 50,
        "seed": 42,
        "pooling": "mean",
        "layers": null,
        "comparison_mode": "pairwise",
        "store_per_layer": true,
        "log_samples": false,
        "variants": [
          {
            "name": "histopathology",
            "dataset": {
              "_target_": "cotlab.datasets.HistopathologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.HistopathologyPromptStrategy"
            }
          },
          {
            "name": "radiology",
            "dataset": {
              "_target_": "cotlab.datasets.RadiologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.RadiologyPromptStrategy"
            }
          }
        ]
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2026-01-24T11:08:11.545870"
  },
  "experiment": "activation_compare",
  "model": "google/medgemma-4b-it",
  "prompt_strategy": "histopathology",
  "metrics": {
    "num_runs": 2,
    "num_layers": 34,
    "comparison_mode": "pairwise",
    "pooling": "mean",
    "pair_count": 1
  },
  "raw_outputs": [
    {
      "runs": [
        {
          "name": "histopathology",
          "dataset": "histopathology",
          "prompt": "histopathology",
          "num_samples": 50,
          "seed": 42,
          "pooling": "mean",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            120.83087158203125,
            87.6873550415039,
            128.8971710205078,
            176.0468292236328,
            243.05287170410156,
            621.1054077148438,
            249.1084747314453,
            97.71522521972656,
            924.8820190429688,
            345.3980712890625,
            2213.299072265625,
            2330.412353515625,
            2176.971923828125,
            1428.3258056640625,
            636.7635498046875,
            1011.3818359375,
            1371.6114501953125,
            1200.7413330078125,
            716.2978515625,
            685.2979125976562,
            599.0812377929688,
            845.6275634765625,
            1150.6029052734375,
            1303.6279296875,
            1425.19775390625,
            1454.8197021484375,
            2011.7255859375,
            2029.5189208984375,
            3696.291748046875,
            2200.105712890625,
            1918.1483154296875,
            3238.43115234375,
            4162.3154296875,
            9775.7314453125
          ],
          "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
        },
        {
          "name": "radiology",
          "dataset": "radiology",
          "prompt": "radiology",
          "num_samples": 50,
          "seed": 42,
          "pooling": "mean",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            131.43275451660156,
            86.24018096923828,
            132.67942810058594,
            173.41461181640625,
            265.8385314941406,
            616.5159912109375,
            154.42086791992188,
            82.87448120117188,
            919.4865112304688,
            150.8663330078125,
            2194.7724609375,
            2186.18701171875,
            2018.70166015625,
            1234.7801513671875,
            489.3358459472656,
            954.7227172851562,
            1223.2611083984375,
            1196.9556884765625,
            682.600341796875,
            809.8561401367188,
            652.6612548828125,
            863.2239379882812,
            1130.351318359375,
            1167.0948486328125,
            1323.02587890625,
            1363.12353515625,
            2147.05078125,
            2016.626708984375,
            3611.018798828125,
            2152.88330078125,
            1915.5010986328125,
            3332.922607421875,
            5779.85107421875,
            4323.779296875
          ],
          "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
        }
      ],
      "comparisons": [
        {
          "run_a": "histopathology",
          "run_b": "radiology",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_cosine_similarity": 0.9285257432684899,
          "mean_l2_distance": 631.8099128638996,
          "layer_cosine_similarity": [
            0.9289790940779405,
            0.9958505439058544,
            0.998880567952449,
            0.9983368194847448,
            0.9987439605699382,
            0.9991737044604045,
            0.9343342582200986,
            0.8345589055494195,
            0.999129911701361,
            0.922066143129077,
            0.9996853441390225,
            0.9993562939806078,
            0.9994173606722891,
            0.9981134491908095,
            0.9828283631629141,
            0.9898327620823737,
            0.9894186063144318,
            0.983925983527562,
            0.9550342590186974,
            0.9377924306218415,
            0.8474912059775376,
            0.9097484428853915,
            0.8485397538262575,
            0.8440789506115025,
            0.7486494825049249,
            0.7626701944784401,
            0.8500753714105393,
            0.8606526074440319,
            0.9567460398030205,
            0.9094361722858161,
            0.8505320285739928,
            0.9631503024059058,
            0.9617139125141682,
            0.8109320446452957
          ],
          "layer_l2_distance": [
            48.66407775878906,
            8.053285598754883,
            7.252488613128662,
            10.41762638092041,
            26.105575561523438,
            25.574932098388672,
            118.39665222167969,
            53.849430084228516,
            38.84757614135742,
            214.393798828125,
            58.3845329284668,
            165.4283447265625,
            173.6968994140625,
            210.03439331054688,
            180.09873962402344,
            151.14572143554688,
            239.8263702392578,
            214.9850616455078,
            212.38461303710938,
            290.7991943359375,
            349.47357177734375,
            363.4155578613281,
            627.9999389648438,
            702.2080688476562,
            978.9378662109375,
            974.5281982421875,
            1146.056396484375,
            1068.0836181640625,
            1077.9239501953125,
            927.4437866210938,
            1048.02734375,
            896.8811645507812,
            2111.53271484375,
            6760.685546875
          ]
        }
      ]
    }
  ],
  "num_samples": 2,
  "samples": [
    {
      "run_summary": {
        "name": "histopathology",
        "dataset": "histopathology",
        "prompt": "histopathology",
        "num_samples": 50,
        "seed": 42,
        "pooling": "mean",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          120.83087158203125,
          87.6873550415039,
          128.8971710205078,
          176.0468292236328,
          243.05287170410156,
          621.1054077148438,
          249.1084747314453,
          97.71522521972656,
          924.8820190429688,
          345.3980712890625,
          2213.299072265625,
          2330.412353515625,
          2176.971923828125,
          1428.3258056640625,
          636.7635498046875,
          1011.3818359375,
          1371.6114501953125,
          1200.7413330078125,
          716.2978515625,
          685.2979125976562,
          599.0812377929688,
          845.6275634765625,
          1150.6029052734375,
          1303.6279296875,
          1425.19775390625,
          1454.8197021484375,
          2011.7255859375,
          2029.5189208984375,
          3696.291748046875,
          2200.105712890625,
          1918.1483154296875,
          3238.43115234375,
          4162.3154296875,
          9775.7314453125
        ],
        "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
      },
      "idx": 0,
      "timestamp": "2026-01-24T11:09:03.356515"
    },
    {
      "run_summary": {
        "name": "radiology",
        "dataset": "radiology",
        "prompt": "radiology",
        "num_samples": 50,
        "seed": 42,
        "pooling": "mean",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          131.43275451660156,
          86.24018096923828,
          132.67942810058594,
          173.41461181640625,
          265.8385314941406,
          616.5159912109375,
          154.42086791992188,
          82.87448120117188,
          919.4865112304688,
          150.8663330078125,
          2194.7724609375,
          2186.18701171875,
          2018.70166015625,
          1234.7801513671875,
          489.3358459472656,
          954.7227172851562,
          1223.2611083984375,
          1196.9556884765625,
          682.600341796875,
          809.8561401367188,
          652.6612548828125,
          863.2239379882812,
          1130.351318359375,
          1167.0948486328125,
          1323.02587890625,
          1363.12353515625,
          2147.05078125,
          2016.626708984375,
          3611.018798828125,
          2152.88330078125,
          1915.5010986328125,
          3332.922607421875,
          5779.85107421875,
          4323.779296875
        ],
        "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
      },
      "idx": 1,
      "timestamp": "2026-01-24T11:09:27.160128"
    }
  ],
  "end_time": "2026-01-24T11:09:27.163836",
  "duration_seconds": 75.617968
}