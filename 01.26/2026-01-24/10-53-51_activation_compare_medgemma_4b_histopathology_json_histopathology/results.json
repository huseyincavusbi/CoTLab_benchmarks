{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true,
        "load_in_4bit": true,
        "bnb_4bit_quant_type": "nf4",
        "bnb_4bit_compute_dtype": "bfloat16",
        "bnb_4bit_use_double_quant": true
      },
      "model": {
        "name": "google/medgemma-4b-it",
        "variant": "4b",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9,
        "safe_name": "medgemma_4b"
      },
      "prompt": {
        "_target_": "cotlab.prompts.HistopathologyPromptStrategy",
        "name": "histopathology",
        "output_format": "json",
        "few_shot": true,
        "answer_first": false,
        "contrarian": false
      },
      "dataset": {
        "_target_": "cotlab.datasets.HistopathologyDataset",
        "name": "histopathology",
        "path": "data/histopathology.tsv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.ActivationCompareExperiment",
        "name": "activation_compare",
        "description": "Compare residual stream activations across runs",
        "num_samples": 50,
        "seed": 42,
        "pooling": "last_token",
        "layers": null,
        "comparison_mode": "pairwise",
        "store_per_layer": true,
        "log_samples": false,
        "variants": [
          {
            "name": "histopathology",
            "dataset": {
              "_target_": "cotlab.datasets.HistopathologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.HistopathologyPromptStrategy"
            }
          },
          {
            "name": "radiology",
            "dataset": {
              "_target_": "cotlab.datasets.RadiologyDataset"
            },
            "prompt": {
              "_target_": "cotlab.prompts.RadiologyPromptStrategy"
            }
          }
        ]
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2026-01-24T10:54:08.342686"
  },
  "experiment": "activation_compare",
  "model": "google/medgemma-4b-it",
  "prompt_strategy": "histopathology",
  "metrics": {
    "num_runs": 2,
    "num_layers": 34,
    "comparison_mode": "pairwise",
    "pooling": "last_token",
    "pair_count": 1
  },
  "raw_outputs": [
    {
      "runs": [
        {
          "name": "histopathology",
          "dataset": "histopathology",
          "prompt": "histopathology",
          "num_samples": 50,
          "seed": 42,
          "pooling": "last_token",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            366.0378112792969,
            71.42440032958984,
            74.81118774414062,
            228.662353515625,
            138.70481872558594,
            756.4298706054688,
            559.7496948242188,
            196.50262451171875,
            232.83888244628906,
            427.68792724609375,
            3345.202880859375,
            2031.991455078125,
            1502.5645751953125,
            781.7193603515625,
            2904.923095703125,
            1293.0665283203125,
            1765.2825927734375,
            3381.238037109375,
            1666.3248291015625,
            1800.04931640625,
            2131.427734375,
            2678.514892578125,
            3099.658935546875,
            3567.143310546875,
            4017.94775390625,
            4047.62255859375,
            4399.16796875,
            4070.854736328125,
            7140.9716796875,
            4653.60302734375,
            3727.505126953125,
            4087.905517578125,
            6373.017578125,
            10865.62890625
          ],
          "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
        },
        {
          "name": "radiology",
          "dataset": "radiology",
          "prompt": "radiology",
          "num_samples": 50,
          "seed": 42,
          "pooling": "last_token",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_activation_norms": [
            369.3719482421875,
            80.70661163330078,
            74.92723083496094,
            197.46644592285156,
            96.1675796508789,
            664.2681274414062,
            307.418212890625,
            226.3499755859375,
            539.0938110351562,
            367.80706787109375,
            2548.63916015625,
            1730.5948486328125,
            1229.248046875,
            548.6250610351562,
            2442.212646484375,
            1025.8111572265625,
            1532.48046875,
            2723.51318359375,
            1972.7132568359375,
            1783.385498046875,
            2423.667236328125,
            2780.765869140625,
            3443.33251953125,
            3458.09375,
            4319.142578125,
            4817.21630859375,
            5313.02490234375,
            5145.1845703125,
            8297.033203125,
            5223.1904296875,
            4413.9208984375,
            5106.63525390625,
            8171.47802734375,
            9325.931640625
          ],
          "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
        }
      ],
      "comparisons": [
        {
          "run_a": "histopathology",
          "run_b": "radiology",
          "layer_indices": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33
          ],
          "mean_cosine_similarity": 0.8314370985653231,
          "mean_l2_distance": 1387.0122977705562,
          "layer_cosine_similarity": [
            0.9992638444055989,
            0.9758026213975055,
            0.9734065317409663,
            0.9820356142170343,
            0.6284879464442596,
            0.9971050018185084,
            0.9627461103951859,
            0.9034671966996594,
            0.11335365077934545,
            0.8855772836195229,
            0.9961529326279379,
            0.9857999479035442,
            0.9679108230622534,
            0.5276975141190161,
            0.9794989456532157,
            0.09435236620293554,
            0.8724193340309863,
            0.9506969711514341,
            0.7847080827006484,
            0.7794105427208288,
            0.829509986843459,
            0.8558784306212285,
            0.8489415876616063,
            0.7664100958565495,
            0.9151756156617835,
            0.8357577701492963,
            0.8950061284681636,
            0.827027431168561,
            0.895967788758201,
            0.8177443921322943,
            0.779915751089184,
            0.7877491647841517,
            0.9056557282170706,
            0.94822821811905
          ],
          "layer_l2_distance": [
            14.501608848571777,
            19.108333587646484,
            17.266963958740234,
            50.94560623168945,
            108.26144409179688,
            106.78568267822266,
            276.5721130371094,
            97.35552215576172,
            562.4760131835938,
            198.95904541015625,
            836.7266235351562,
            436.7032775878906,
            439.5920715332031,
            677.8248291015625,
            710.6276245117188,
            1572.896240234375,
            862.8302612304688,
            1157.868896484375,
            1228.52880859375,
            1190.18603515625,
            1358.9930419921875,
            1468.802734375,
            1828.2923583984375,
            2403.080810546875,
            1742.074462890625,
            2645.213623046875,
            2396.48876953125,
            2898.294921875,
            3696.496337890625,
            3030.59228515625,
            2777.26708984375,
            3146.342529296875,
            3613.97314453125,
            3586.489013671875
          ]
        }
      ]
    }
  ],
  "num_samples": 2,
  "samples": [
    {
      "run_summary": {
        "name": "histopathology",
        "dataset": "histopathology",
        "prompt": "histopathology",
        "num_samples": 50,
        "seed": 42,
        "pooling": "last_token",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          366.0378112792969,
          71.42440032958984,
          74.81118774414062,
          228.662353515625,
          138.70481872558594,
          756.4298706054688,
          559.7496948242188,
          196.50262451171875,
          232.83888244628906,
          427.68792724609375,
          3345.202880859375,
          2031.991455078125,
          1502.5645751953125,
          781.7193603515625,
          2904.923095703125,
          1293.0665283203125,
          1765.2825927734375,
          3381.238037109375,
          1666.3248291015625,
          1800.04931640625,
          2131.427734375,
          2678.514892578125,
          3099.658935546875,
          3567.143310546875,
          4017.94775390625,
          4047.62255859375,
          4399.16796875,
          4070.854736328125,
          7140.9716796875,
          4653.60302734375,
          3727.505126953125,
          4087.905517578125,
          6373.017578125,
          10865.62890625
        ],
        "system_prompt": "You are a histopathology expert specializing in evaluating report quality.\nYour goal is to assess the clinical accuracy, completeness, and clarity of histopathology reports.\nThink rationally and explain your reasoning for quality ratings."
      },
      "idx": 0,
      "timestamp": "2026-01-24T10:55:30.578149"
    },
    {
      "run_summary": {
        "name": "radiology",
        "dataset": "radiology",
        "prompt": "radiology",
        "num_samples": 50,
        "seed": 42,
        "pooling": "last_token",
        "layer_indices": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "mean_activation_norms": [
          369.3719482421875,
          80.70661163330078,
          74.92723083496094,
          197.46644592285156,
          96.1675796508789,
          664.2681274414062,
          307.418212890625,
          226.3499755859375,
          539.0938110351562,
          367.80706787109375,
          2548.63916015625,
          1730.5948486328125,
          1229.248046875,
          548.6250610351562,
          2442.212646484375,
          1025.8111572265625,
          1532.48046875,
          2723.51318359375,
          1972.7132568359375,
          1783.385498046875,
          2423.667236328125,
          2780.765869140625,
          3443.33251953125,
          3458.09375,
          4319.142578125,
          4817.21630859375,
          5313.02490234375,
          5145.1845703125,
          8297.033203125,
          5223.1904296875,
          4413.9208984375,
          5106.63525390625,
          8171.47802734375,
          9325.931640625
        ],
        "system_prompt": "You are a radiology expert specialised in paedeatric radiology.\nYour goal is to identify incidence of pathological fractures in the given radiology report.\nDo not make assumptions or diagnoses from the text.\nThink rationally and explain your reasoning."
      },
      "idx": 1,
      "timestamp": "2026-01-24T10:55:54.343006"
    }
  ],
  "end_time": "2026-01-24T10:55:54.350432",
  "duration_seconds": 106.007748
}