{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true
      },
      "model": {
        "name": "google/medgemma-27b-text-it",
        "variant": "27b-text",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9
      },
      "prompt": {
        "_target_": "cotlab.prompts.ChainOfThoughtStrategy",
        "name": "chain_of_thought",
        "system_role": "You are a medical expert. Think through problems carefully and\nexplain your reasoning step by step before giving your final answer.\n",
        "include_examples": false,
        "cot_trigger": "Let's think through this step by step:"
      },
      "dataset": {
        "_target_": "cotlab.datasets.PatchingPairsDataset",
        "name": "patching_pairs",
        "path": "data/Patching_Pairs_Data.csv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.LogitLensExperiment",
        "name": "logit_lens",
        "description": "Visualize layer-by-layer token predictions",
        "top_k": 5,
        "question": "Patient presents with chest pain, sweating, and shortness of breath. What is the diagnosis?"
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2025-12-25T10:55:43.356014"
  },
  "experiment": "logit_lens",
  "model": "google/medgemma-27b-text-it",
  "prompt_strategy": "chain_of_thought",
  "metrics": {
    "final_prediction": "1",
    "num_layers_analyzed": 62,
    "emergence_layer": 59,
    "emergence_rank": 2
  },
  "raw_outputs": [
    {
      "layer": 0,
      "top_tokens": [
        "<unused1044>",
        "<unused1001>",
        "<unused179>",
        "\u04e3",
        "\u0e99"
      ],
      "top_probs": [
        0.44140625,
        0.302734375,
        0.18359375,
        0.01177978515625,
        0.008056640625
      ]
    },
    {
      "layer": 1,
      "top_tokens": [
        "\ufffd",
        "\u0bb6",
        "\ufeaf",
        "\u0c3f",
        "\u0c32\u0c4d\u200c"
      ],
      "top_probs": [
        1.8358230590820312e-05,
        1.7404556274414062e-05,
        1.728534698486328e-05,
        1.6927719116210938e-05,
        1.621246337890625e-05
      ]
    },
    {
      "layer": 2,
      "top_tokens": [
        "\ufe8e",
        "\u24d4",
        "\u0cae\u0ccd",
        "\u00edonn",
        "\u1255"
      ],
      "top_probs": [
        9.5367431640625e-05,
        8.153915405273438e-05,
        7.200241088867188e-05,
        6.67572021484375e-05,
        6.341934204101562e-05
      ]
    },
    {
      "layer": 3,
      "top_tokens": [
        "<unused1155>",
        "<unused273>",
        "<unused216>",
        "<unused679>",
        "posTocco"
      ],
      "top_probs": [
        0.00012493133544921875,
        0.00010013580322265625,
        9.72747802734375e-05,
        9.298324584960938e-05,
        8.440017700195312e-05
      ]
    },
    {
      "layer": 4,
      "top_tokens": [
        "\u0c83",
        "\u1255",
        "\u1585",
        " ngok",
        "\u0e99"
      ],
      "top_probs": [
        0.38671875,
        0.11083984375,
        0.0859375,
        0.076171875,
        0.035888671875
      ]
    },
    {
      "layer": 5,
      "top_tokens": [
        "\u0c83",
        "\u1585",
        "\u0e99",
        "\ufe8e",
        " ngok"
      ],
      "top_probs": [
        0.0020904541015625,
        0.00081634521484375,
        0.000766754150390625,
        0.000720977783203125,
        0.000698089599609375
      ]
    },
    {
      "layer": 6,
      "top_tokens": [
        "a",
        "P",
        "as",
        "A",
        "G"
      ],
      "top_probs": [
        0.0003719329833984375,
        0.000255584716796875,
        0.00019931793212890625,
        0.000186920166015625,
        0.0001697540283203125
      ]
    },
    {
      "layer": 7,
      "top_tokens": [
        "CasePTV",
        "CollinToDO",
        "sscType",
        "posTocco",
        "\ud808\udd32"
      ],
      "top_probs": [
        0.431640625,
        0.1591796875,
        0.0849609375,
        0.06640625,
        0.0517578125
      ]
    },
    {
      "layer": 8,
      "top_tokens": [
        "CasePTV",
        "CollinToDO",
        "CaseMissense",
        "posTocco",
        "MalayMarks"
      ],
      "top_probs": [
        0.9921875,
        0.006683349609375,
        2.7298927307128906e-05,
        1.6570091247558594e-05,
        6.109476089477539e-06
      ]
    },
    {
      "layer": 9,
      "top_tokens": [
        "CasePTV",
        "CollinToDO",
        "MalayMarks",
        "CaseMissense",
        "posTocco"
      ],
      "top_probs": [
        1.0,
        4.5299530029296875e-05,
        1.525040715932846e-08,
        2.7830537874251604e-10,
        2.7830537874251604e-10
      ]
    },
    {
      "layer": 10,
      "top_tokens": [
        "T",
        ")\u3002",
        "\u5927\u5207",
        "\u0e04\u0e34\u0e14",
        "$."
      ],
      "top_probs": [
        0.005126953125,
        0.0045166015625,
        0.002197265625,
        0.002197265625,
        0.0020751953125
      ]
    },
    {
      "layer": 11,
      "top_tokens": [
        "CasePTV",
        "CollinToDO",
        "MalayMarks",
        "CaseMissense",
        "posTocco"
      ],
      "top_probs": [
        0.921875,
        0.07568359375,
        0.002288818359375,
        0.00051116943359375,
        0.00018787384033203125
      ]
    },
    {
      "layer": 12,
      "top_tokens": [
        "MalayMarks",
        "<unused1131>",
        "<unused1039>",
        "CollinToDO",
        "CasePTV"
      ],
      "top_probs": [
        0.61328125,
        0.13671875,
        0.10693359375,
        0.0238037109375,
        0.0238037109375
      ]
    },
    {
      "layer": 13,
      "top_tokens": [
        "<unused179>",
        "<unused1044>",
        "<unused1001>",
        "<unused1177>",
        "<unused1094>"
      ],
      "top_probs": [
        0.796875,
        0.177734375,
        0.01458740234375,
        0.00885009765625,
        0.00119781494140625
      ]
    },
    {
      "layer": 14,
      "top_tokens": [
        "CasePTV",
        "MalayMarks",
        "CollinToDO",
        "ControlPTV",
        "DenovoMis"
      ],
      "top_probs": [
        0.87890625,
        0.119140625,
        0.0021820068359375,
        3.981590270996094e-05,
        1.4662742614746094e-05
      ]
    },
    {
      "layer": 15,
      "top_tokens": [
        "MalayMarks",
        "<unused1131>",
        "<unused1085>",
        "<unused1039>",
        "<unused1053>"
      ],
      "top_probs": [
        0.40625,
        0.40625,
        0.09033203125,
        0.033203125,
        0.0201416015625
      ]
    },
    {
      "layer": 16,
      "top_tokens": [
        "MalayMarks",
        "CasePTV",
        "CollinToDO",
        "ControlPTV",
        "CaseMissense"
      ],
      "top_probs": [
        0.87890625,
        0.119140625,
        7.338821887969971e-07,
        9.918585419654846e-08,
        1.8189894035458565e-09
      ]
    },
    {
      "layer": 17,
      "top_tokens": [
        "CasePTV",
        "MalayMarks",
        "CollinToDO",
        "CaseMissense",
        "ControlPTV"
      ],
      "top_probs": [
        1.0,
        8.307397365570068e-07,
        8.307397365570068e-07,
        6.927791673660977e-13,
        9.370282327836321e-14
      ]
    },
    {
      "layer": 18,
      "top_tokens": [
        "MalayMarks",
        "ControlPTV",
        "CasePTV",
        " ControlMissense",
        "<unused1131>"
      ],
      "top_probs": [
        0.99609375,
        0.00090789794921875,
        0.00090789794921875,
        0.0003337860107421875,
        0.00020313262939453125
      ]
    },
    {
      "layer": 19,
      "top_tokens": [
        " ngok",
        "\u0e99",
        "\u1255",
        "\u0c83",
        "\u09f0"
      ],
      "top_probs": [
        1.0,
        4.5299530029296875e-05,
        6.139278411865234e-06,
        5.617039278149605e-09,
        1.0277290130034089e-10
      ]
    },
    {
      "layer": 20,
      "top_tokens": [
        "\u0e99",
        "\u1585",
        " \u0442\u043e\u043b\u044c\u043a\u0456",
        "\u04a1",
        "\u1161"
      ],
      "top_probs": [
        0.447265625,
        0.271484375,
        0.271484375,
        0.003021240234375,
        0.00142669677734375
      ]
    },
    {
      "layer": 21,
      "top_tokens": [
        "\u1255",
        " ngok",
        "\u0e99",
        "\u0c83",
        "\u1585"
      ],
      "top_probs": [
        0.98046875,
        0.0179443359375,
        6.020069122314453e-06,
        2.7466739993542433e-10,
        5.030642569181509e-12
      ]
    },
    {
      "layer": 22,
      "top_tokens": [
        "\u1255",
        " ngok",
        "<unused1044>",
        "\u09f0",
        " futhi"
      ],
      "top_probs": [
        0.953125,
        0.04736328125,
        3.934837877750397e-08,
        4.860112312599085e-12,
        1.7905676941154525e-12
      ]
    },
    {
      "layer": 23,
      "top_tokens": [
        "<unused179>",
        "<unused1001>",
        "<unused1177>",
        "<unused1044>",
        "<unused118>"
      ],
      "top_probs": [
        1.0,
        6.927791673660977e-13,
        2.3245294578089215e-16,
        3.144186300207963e-17,
        4.255493527005605e-18
      ]
    },
    {
      "layer": 24,
      "top_tokens": [
        "\u1255",
        "\u0c83",
        "\u0e99",
        " ngok",
        " futhi"
      ],
      "top_probs": [
        0.99609375,
        0.002471923828125,
        0.0003337860107421875,
        0.0003337860107421875,
        8.307397365570068e-07
      ]
    },
    {
      "layer": 25,
      "top_tokens": [
        "\u1255",
        "\u09f0",
        "\ufe8e",
        "\u0c83",
        " \u043a\u045e"
      ],
      "top_probs": [
        1.0,
        3.441691376337985e-14,
        3.144186300207963e-17,
        1.565316886525947e-18,
        7.792703114739563e-20
      ]
    },
    {
      "layer": 26,
      "top_tokens": [
        "\u1296\u127d",
        "\u092a\u0940\u0930\u093f\u092f",
        " \u0b95\u0bc7\u0bb0\u0bb3",
        " aw\u1ecdn",
        " osh"
      ],
      "top_probs": [
        0.9453125,
        0.047119140625,
        0.006378173828125,
        5.811452865600586e-06,
        1.0663643479347229e-07
      ]
    },
    {
      "layer": 27,
      "top_tokens": [
        "scre",
        "\u986f",
        " \u0627\u0644\u0642\u0633\u0645\u0647",
        " Resting",
        " dices"
      ],
      "top_probs": [
        0.6875,
        0.251953125,
        0.056396484375,
        0.004608154296875,
        0.00102996826171875
      ]
    },
    {
      "layer": 28,
      "top_tokens": [
        " ngok",
        "\u1255",
        " nke",
        " \u0d08",
        "\u0e99"
      ],
      "top_probs": [
        0.9375,
        0.046630859375,
        0.01708984375,
        0.00011539459228515625,
        4.2438507080078125e-05
      ]
    },
    {
      "layer": 29,
      "top_tokens": [
        "CollinToDO",
        "posTocco",
        "CasePTV",
        "sscType",
        "CaseMissense"
      ],
      "top_probs": [
        0.96484375,
        0.0177001953125,
        0.0177001953125,
        1.9936123862862587e-09,
        3.637978807091713e-11
      ]
    },
    {
      "layer": 30,
      "top_tokens": [
        "CasePTV",
        "CollinToDO",
        "MalayMarks",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        1.2656542480726785e-14,
        1.601387637598654e-28,
        0.0,
        0.0
      ]
    },
    {
      "layer": 31,
      "top_tokens": [
        "\u09f0",
        " \u0905\u0936\u0941\u092d",
        "\u1075",
        " \u0c26\u0c30\u0c4d\u0c36\u0c15",
        "\u0c83"
      ],
      "top_probs": [
        0.9765625,
        0.017822265625,
        0.006561279296875,
        8.121132850646973e-07,
        2.980232238769531e-07
      ]
    },
    {
      "layer": 32,
      "top_tokens": [
        "<unused1077>",
        "<unused1044>",
        "<unused1001>",
        "<unused1078>",
        "\u1021"
      ],
      "top_probs": [
        1.0,
        1.6689300537109375e-05,
        1.525040715932846e-08,
        7.566995918750763e-10,
        2.7830537874251604e-10
      ]
    },
    {
      "layer": 33,
      "top_tokens": [
        "<unused179>",
        "<unused1177>",
        "<unused1044>",
        "<unused1078>",
        "<unused118>"
      ],
      "top_probs": [
        1.0,
        1.2656542480726785e-14,
        2.3245294578089215e-16,
        7.792703114739563e-20,
        7.792703114739563e-20
      ]
    },
    {
      "layer": 34,
      "top_tokens": [
        "<unused1044>",
        "<unused179>",
        "<unused1094>",
        "<unused1177>",
        "<unused1078>"
      ],
      "top_probs": [
        0.5,
        0.5,
        5.634501576423645e-08,
        3.4638958368304884e-13,
        6.328271240363392e-15
      ]
    },
    {
      "layer": 35,
      "top_tokens": [
        "<unused1039>",
        "MalayMarks",
        "<unused1131>",
        "<unused1176>",
        " ControlMissense"
      ],
      "top_probs": [
        1.0,
        7.792703114739563e-20,
        1.4227506535912076e-21,
        1.9273308272485545e-22,
        3.54136699749265e-24
      ]
    },
    {
      "layer": 36,
      "top_tokens": [
        "\u307e\u305a",
        "saan",
        "goal",
        "Embarked",
        "So"
      ],
      "top_probs": [
        1.0,
        1.525040715932846e-08,
        3.774403012357652e-11,
        5.115907697472721e-12,
        1.8758328224066645e-12
      ]
    },
    {
      "layer": 37,
      "top_tokens": [
        "<unused379>",
        "<unused179>",
        "<unused608>",
        "<unused1110>",
        "<unused335>"
      ],
      "top_probs": [
        1.0,
        1.525040715932846e-08,
        6.927791673660977e-13,
        1.7139067942650854e-15,
        5.759824041329242e-19
      ]
    },
    {
      "layer": 38,
      "top_tokens": [
        " \u0627\u0631\u0628\u0639\u0647",
        " quatre",
        "\u9875\u9762\u5b58\u6863\u5907\u4efd",
        "keV",
        " \u062e\u0645\u0633\u0647"
      ],
      "top_probs": [
        0.87890625,
        0.119140625,
        0.00080108642578125,
        0.0001087188720703125,
        4.00543212890625e-05
      ]
    },
    {
      "layer": 39,
      "top_tokens": [
        "wedge",
        "noop",
        " \u0c39\u0c46",
        " think",
        " Step"
      ],
      "top_probs": [
        1.0,
        4.5299530029296875e-05,
        1.126900315284729e-07,
        2.7830537874251604e-10,
        1.0277290130034089e-10
      ]
    },
    {
      "layer": 40,
      "top_tokens": [
        "<unused1154>",
        "\u09be\u099c\u09c7",
        "<unused1092>",
        "<unused1177>",
        "<unused320>"
      ],
      "top_probs": [
        1.0,
        8.307397365570068e-07,
        1.126900315284729e-07,
        1.525040715932846e-08,
        3.774403012357652e-11
      ]
    },
    {
      "layer": 41,
      "top_tokens": [
        "Prem",
        " premise",
        "prem",
        " prem",
        " Prem"
      ],
      "top_probs": [
        1.0,
        5.115907697472721e-12,
        1.2656542480726785e-14,
        8.734267942607043e-27,
        2.1693674893577825e-29
      ]
    },
    {
      "layer": 42,
      "top_tokens": [
        " observa",
        " stvari",
        " \u091a\u093e\u091a\u093e",
        " observar",
        " Koreans"
      ],
      "top_probs": [
        1.0,
        1.525040715932846e-08,
        1.2656542480726785e-14,
        4.255493527005605e-18,
        2.6056189295420372e-23
      ]
    },
    {
      "layer": 43,
      "top_tokens": [
        " congratulations",
        "\u5cc4",
        " Myr",
        " \u0445\u043e\u0434\u0435",
        "\u65e5\u306f"
      ],
      "top_probs": [
        1.0,
        8.307397365570068e-07,
        1.126900315284729e-07,
        1.525040715932846e-08,
        6.927791673660977e-13
      ]
    },
    {
      "layer": 44,
      "top_tokens": [
        "<unused179>",
        "<unused1177>",
        "<unused373>",
        "<unused1078>",
        "<unused608>"
      ],
      "top_probs": [
        1.0,
        5.759824041329242e-19,
        7.792703114739563e-20,
        1.4227506535912076e-21,
        1.9273308272485545e-22
      ]
    },
    {
      "layer": 45,
      "top_tokens": [
        " step",
        "Step",
        " Step",
        " \ub2e8\uacc4",
        " \u044d\u0442\u0430\u043f"
      ],
      "top_probs": [
        1.0,
        7.792703114739563e-20,
        2.9335764912906377e-30,
        1.3316000006114873e-34,
        2.445028249710358e-36
      ]
    },
    {
      "layer": 46,
      "top_tokens": [
        " \u0967",
        "\u09e7",
        "<bos>",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        9.183549615799121e-41,
        0.0,
        0.0,
        0.0
      ]
    },
    {
      "layer": 47,
      "top_tokens": [
        "<unused179>",
        "<unused1044>",
        "<unused731>",
        "<unused1090>",
        "<unused379>"
      ],
      "top_probs": [
        1.0,
        3.774403012357652e-11,
        3.774403012357652e-11,
        6.927791673660977e-13,
        6.927791673660977e-13
      ]
    },
    {
      "layer": 48,
      "top_tokens": [
        "opol",
        " Spell",
        " segura",
        " pronunci",
        " mason"
      ],
      "top_probs": [
        1.0,
        0.000335693359375,
        0.000335693359375,
        0.000335693359375,
        6.139278411865234e-06
      ]
    },
    {
      "layer": 49,
      "top_tokens": [
        " \u09a8\u09c7",
        " \u0926\u094d",
        "Form",
        "\u09a8\u09be\u09b0\u09c0",
        "leases"
      ],
      "top_probs": [
        1.0,
        3.774403012357652e-11,
        5.115907697472721e-12,
        6.927791673660977e-13,
        9.370282327836321e-14
      ]
    },
    {
      "layer": 50,
      "top_tokens": [
        " Size",
        " size",
        " \u30b5\u30a4\u30ba",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        1.7139067942650854e-15,
        2.1693674893577825e-29,
        0.0,
        0.0
      ]
    },
    {
      "layer": 51,
      "top_tokens": [
        "<unused1078>",
        "<unused1039>",
        "<unused1001>",
        "<unused206>",
        "<unused1090>"
      ],
      "top_probs": [
        1.0,
        6.139278411865234e-06,
        2.7830537874251604e-10,
        2.3245294578089215e-16,
        3.144186300207963e-17
      ]
    },
    {
      "layer": 52,
      "top_tokens": [
        "\u0a67",
        "<unused1044>",
        "<unused568>",
        "<unused1140>",
        "<unused179>"
      ],
      "top_probs": [
        0.98046875,
        0.0179443359375,
        1.103617250919342e-07,
        7.623296525288703e-20,
        8.582806648804608e-27
      ]
    },
    {
      "layer": 53,
      "top_tokens": [
        " Harv",
        " kesel",
        "\u7e67",
        " Gruppen",
        "South"
      ],
      "top_probs": [
        0.87890625,
        0.119140625,
        4.00543212890625e-05,
        1.8189894035458565e-09,
        1.8189894035458565e-09
      ]
    },
    {
      "layer": 54,
      "top_tokens": [
        "<unused1177>",
        "<unused1044>",
        "<unused1176>",
        "<unused219>",
        "<unused1090>"
      ],
      "top_probs": [
        1.0,
        2.3245294578089215e-16,
        2.6056189295420372e-23,
        8.734267942607043e-27,
        2.9335764912906377e-30
      ]
    },
    {
      "layer": 55,
      "top_tokens": [
        "\u092e\u093e\u0928\u093e",
        "#-",
        "*{-",
        "\u0906\u0924\u094d\u092e",
        "#>"
      ],
      "top_probs": [
        1.0,
        0.000335693359375,
        6.927791673660977e-13,
        4.255493527005605e-18,
        7.792703114739563e-20
      ]
    },
    {
      "layer": 56,
      "top_tokens": [
        "\u09b8\u09c2\u09b0\u09be",
        "Ste",
        "<bos>",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        4.782137916322191e-25,
        0.0,
        0.0,
        0.0
      ]
    },
    {
      "layer": 57,
      "top_tokens": [
        "<unused1044>",
        "<unused1001>",
        "<bos>",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        4.255493527005605e-18,
        0.0,
        0.0,
        0.0
      ]
    },
    {
      "layer": 58,
      "top_tokens": [
        "<unused377>",
        "<bos>",
        "<pad>",
        "<unk>",
        "<eos>"
      ],
      "top_probs": [
        1.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    },
    {
      "layer": 59,
      "top_tokens": [
        "<unused1126>",
        "1",
        "<bos>",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        1.8055593228630336e-35,
        0.0,
        0.0,
        0.0
      ]
    },
    {
      "layer": 60,
      "top_tokens": [
        "<unused1001>",
        "<unused1140>",
        "<unused1044>",
        "<unused1116>",
        "<unused515>"
      ],
      "top_probs": [
        1.0,
        1.601387637598654e-28,
        1.601387637598654e-28,
        5.39260384428426e-32,
        1.8055593228630336e-35
      ]
    },
    {
      "layer": 61,
      "top_tokens": [
        "<unused1001>",
        "<unused179>",
        "<bos>",
        "<eos>",
        "<pad>"
      ],
      "top_probs": [
        1.0,
        1.8055593228630336e-35,
        0.0,
        0.0,
        0.0
      ]
    }
  ],
  "num_samples": 0,
  "samples": [],
  "end_time": "2025-12-25T10:55:55.110674",
  "duration_seconds": 11.754662
}