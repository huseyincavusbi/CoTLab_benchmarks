{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true
      },
      "model": {
        "name": "google/medgemma-4b-it",
        "variant": "4b",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9
      },
      "prompt": {
        "_target_": "cotlab.prompts.length_matched_strategies.DirectAnswerMatchedStrategy",
        "name": "direct_matched"
      },
      "dataset": {
        "_target_": "cotlab.datasets.PatchingPairsDataset",
        "name": "patching_pairs",
        "path": "data/Patching_Pairs_Data.csv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.AttentionAnalysisExperiment",
        "name": "attention_analysis",
        "description": "Analyze attention patterns at critical layers",
        "target_layers": [
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "num_samples": 20
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2025-12-26T17:50:08.825754"
  },
  "experiment": "attention_analysis",
  "model": "google/medgemma-4b-it",
  "prompt_strategy": "direct_matched",
  "metrics": {
    "num_samples_analyzed": 20,
    "num_layers_analyzed": 9,
    "num_heads": 8,
    "overall_mean_entropy": 1.7745347764756945,
    "most_focused_layer": 28,
    "most_focused_entropy": 1.277191162109375
  },
  "raw_outputs": [
    {
      "layer": 25,
      "mean_entropy": 1.60517578125,
      "std_entropy": 0.06376799834250613,
      "mean_per_head": [
        0.926171875,
        1.38203125,
        1.335546875,
        2.45859375,
        2.8375,
        0.92734375,
        1.683203125,
        1.291015625
      ],
      "std_per_head": [
        0.11643573976292942,
        0.12394328733966395,
        0.1417161443737864,
        0.13810900289151137,
        0.1295462333010883,
        0.13020416659999787,
        0.13910802888824167,
        0.09903326042255639
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": ":",
          "count": 10
        },
        {
          "token": ".",
          "count": 10
        },
        {
          "token": " Patient",
          "count": 7
        },
        {
          "token": " analysis",
          "count": 6
        }
      ]
    },
    {
      "layer": 26,
      "mean_entropy": 2.10458984375,
      "std_entropy": 0.12475711112691493,
      "mean_per_head": [
        2.09140625,
        2.313671875,
        1.915234375,
        2.70703125,
        1.7890625,
        2.1421875,
        2.23203125,
        1.64609375
      ],
      "std_per_head": [
        0.2547893297197952,
        0.20465581517647347,
        0.22859106660677245,
        0.18486923957810694,
        0.1820999736151134,
        0.18618680765228773,
        0.03961330416902257,
        0.1361730179599193
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 17
        },
        {
          "token": ":",
          "count": 15
        },
        {
          "token": " shows",
          "count": 2
        },
        {
          "token": "Give",
          "count": 1
        }
      ]
    },
    {
      "layer": 27,
      "mean_entropy": 1.5727783203125,
      "std_entropy": 0.03588887117291601,
      "mean_per_head": [
        0.7080078125,
        3.3640625,
        1.408203125,
        1.362890625,
        0.53798828125,
        0.19912109375,
        2.98984375,
        2.012109375
      ],
      "std_per_head": [
        0.07590472986011293,
        0.09633164151123971,
        0.09887906295974327,
        0.03971909114231939,
        0.030989361075664818,
        0.016953698777012634,
        0.14373938479827825,
        0.1690549003317321
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        }
      ]
    },
    {
      "layer": 28,
      "mean_entropy": 1.277191162109375,
      "std_entropy": 0.04280038816308597,
      "mean_per_head": [
        2.97578125,
        1.2912109375,
        1.161328125,
        0.085595703125,
        1.587109375,
        2.05390625,
        0.37568359375,
        0.6869140625
      ],
      "std_per_head": [
        0.22005608970711876,
        0.17735181613677298,
        0.03923983185867232,
        0.020071180753239798,
        0.07288166477617587,
        0.10116810441815395,
        0.044419211271206224,
        0.0627348492938173
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": " your",
          "count": 20
        }
      ]
    },
    {
      "layer": 29,
      "mean_entropy": 1.7970703125,
      "std_entropy": 0.06611365088580662,
      "mean_per_head": [
        2.50625,
        1.82109375,
        1.887890625,
        2.525,
        1.7359375,
        1.86015625,
        0.488671875,
        1.5515625
      ],
      "std_per_head": [
        0.12774333397481058,
        0.1130223334193844,
        0.15387402502102776,
        0.08332682266233365,
        0.20304385398387464,
        0.16770327858583298,
        0.06310921348859005,
        0.09476662329441206
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": " your",
          "count": 19
        },
        {
          "token": ":",
          "count": 1
        }
      ]
    },
    {
      "layer": 30,
      "mean_entropy": 2.311669921875,
      "std_entropy": 0.08978177794298935,
      "mean_per_head": [
        2.180078125,
        2.58671875,
        2.41875,
        2.440625,
        1.936328125,
        2.46953125,
        2.23671875,
        2.224609375
      ],
      "std_per_head": [
        0.12869241259898298,
        0.13454522285160295,
        0.15684262614162006,
        0.1551995942729877,
        0.13864216230974571,
        0.11239958626341781,
        0.10426395196657134,
        0.14284008469236453
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 17
        },
        {
          "token": " Provide",
          "count": 17
        },
        {
          "token": " poly",
          "count": 1
        },
        {
          "token": " acute",
          "count": 1
        }
      ]
    },
    {
      "layer": 31,
      "mean_entropy": 1.815362548828125,
      "std_entropy": 0.06583201675039137,
      "mean_per_head": [
        0.309033203125,
        0.1748046875,
        1.658203125,
        2.93203125,
        2.3984375,
        2.60703125,
        1.929296875,
        2.5140625
      ],
      "std_per_head": [
        0.03547016292228095,
        0.04328166424384345,
        0.066698575330901,
        0.07801163650179056,
        0.06765823467065928,
        0.08883949602900444,
        0.11091205143850182,
        0.40801599329101057
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 16
        },
        {
          "token": " your",
          "count": 3
        },
        {
          "token": "uda",
          "count": 1
        }
      ]
    },
    {
      "layer": 32,
      "mean_entropy": 1.440924072265625,
      "std_entropy": 0.05261684283091959,
      "mean_per_head": [
        1.476953125,
        2.0171875,
        1.155078125,
        2.4140625,
        0.202001953125,
        1.19609375,
        2.55390625,
        0.512109375
      ],
      "std_per_head": [
        0.15336148432069532,
        0.2195521008781287,
        0.09044550516358939,
        0.074690115016982,
        0.043433735636333466,
        0.09691594396853648,
        0.08621758335564446,
        0.07031955259768836
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        },
        {
          "token": ":",
          "count": 10
        },
        {
          "token": " analysis",
          "count": 6
        },
        {
          "token": " your",
          "count": 4
        }
      ]
    },
    {
      "layer": 33,
      "mean_entropy": 2.046051025390625,
      "std_entropy": 0.05594184063474486,
      "mean_per_head": [
        3.21640625,
        2.10546875,
        1.980859375,
        1.94765625,
        1.5658203125,
        2.77890625,
        2.521875,
        0.251416015625
      ],
      "std_per_head": [
        0.08032450664141982,
        0.08466746188213332,
        0.10699061158249762,
        0.08156863602397983,
        0.25905028090057725,
        0.1656747419409111,
        0.06691441595426205,
        0.03775077258197358
      ],
      "top_tokens": [
        {
          "token": ":",
          "count": 20
        },
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        }
      ]
    }
  ],
  "num_samples": 0,
  "samples": [],
  "end_time": "2025-12-26T17:50:20.152641",
  "duration_seconds": 11.32689
}