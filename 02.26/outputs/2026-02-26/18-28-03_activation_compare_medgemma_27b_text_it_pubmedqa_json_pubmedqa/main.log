============================================================
Configuration:
============================================================
backend:
  _target_: cotlab.backends.TransformersBackend
  device: cuda
  dtype: bfloat16
  enable_hooks: true
  trust_remote_code: true
model:
  name: google/medgemma-27b-text-it
  variant: 27b-text
  max_new_tokens: 512
  temperature: 0.7
  top_p: 0.9
  safe_name: medgemma_27b_text_it
prompt:
  _target_: cotlab.prompts.pubmedqa.PubMedQAPromptStrategy
  name: pubmedqa
  output_format: json
  few_shot: true
  answer_first: false
  contrarian: false
dataset:
  _target_: cotlab.datasets.loaders.PubMedQADataset
  name: pubmedqa
  filename: pubmedqa/test.jsonl
experiment:
  _target_: cotlab.experiments.ActivationCompareExperiment
  name: activation_compare
  description: Collect mean layer activations for representational comparison
  layer_stride: 1
  num_samples: null
  pooling: last_token
  max_input_tokens: 1024
  seed: 42
  answer_cue: '


    Answer:'
  batch_size: 4
seed: 42
verbose: true
dry_run: false

============================================================
Created experiment documentation: /home/ubuntu/CoTLab/outputs/2026-02-26/18-28-03_activation_compare_medgemma_27b_text_it_pubmedqa_json_pubmedqa/EXPERIMENT.md
Loading backend: cotlab.backends.TransformersBackend
Loading model: google/medgemma-27b-text-it
  Device map: cuda
  Dtype: torch.bfloat16
  Cache: ~/.cache/huggingface (HF default)
Loading checkpoint shards:   0%|                                           | 0/11 [00:00<?, ?it/s]Loading checkpoint shards:   9%|███▏                               | 1/11 [00:00<00:07,  1.42it/s]Loading checkpoint shards:  18%|██████▎                            | 2/11 [00:01<00:06,  1.40it/s]Loading checkpoint shards:  27%|█████████▌                         | 3/11 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  36%|████████████▋                      | 4/11 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  45%|███████████████▉                   | 5/11 [00:03<00:04,  1.42it/s]Loading checkpoint shards:  55%|███████████████████                | 6/11 [00:04<00:03,  1.43it/s]Loading checkpoint shards:  64%|██████████████████████▎            | 7/11 [00:04<00:02,  1.40it/s]Loading checkpoint shards:  73%|█████████████████████████▍         | 8/11 [00:05<00:02,  1.40it/s]Loading checkpoint shards:  82%|████████████████████████████▋      | 9/11 [00:06<00:01,  1.42it/s]Loading checkpoint shards:  91%|██████████████████████████████▉   | 10/11 [00:07<00:00,  1.44it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.43it/s]
  Resolved device: cuda:0
Creating prompt strategy: pubmedqa
Loading dataset: pubmedqa
Creating experiment: activation_compare
============================================================
Running experiment: activation_compare
============================================================
Model : google/medgemma-27b-text-it
Layers (62): [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61]
Pooling: last_token
Batch size: 4
Samples: 500

Activation collect:   0%|                                                 | 0/125 [00:00<?, ?it/s]Activation collect:   1%|▎                                        | 1/125 [00:00<02:03,  1.01it/s]Activation collect:   2%|▋                                        | 2/125 [00:01<01:31,  1.35it/s]Activation collect:   2%|▉                                        | 3/125 [00:02<01:18,  1.56it/s]Activation collect:   3%|█▎                                       | 4/125 [00:02<01:16,  1.59it/s]Activation collect:   4%|█▋                                       | 5/125 [00:03<01:15,  1.59it/s]Activation collect:   5%|█▉                                       | 6/125 [00:03<01:14,  1.59it/s]Activation collect:   6%|██▎                                      | 7/125 [00:04<01:12,  1.63it/s]Activation collect:   6%|██▌                                      | 8/125 [00:05<01:10,  1.65it/s]Activation collect:   7%|██▉                                      | 9/125 [00:05<01:09,  1.67it/s]Activation collect:   8%|███▏                                    | 10/125 [00:06<01:06,  1.74it/s]Activation collect:   9%|███▌                                    | 11/125 [00:06<01:05,  1.75it/s]Activation collect:  10%|███▊                                    | 12/125 [00:07<01:07,  1.68it/s]Activation collect:  10%|████▏                                   | 13/125 [00:07<01:05,  1.72it/s]Activation collect:  11%|████▍                                   | 14/125 [00:08<01:06,  1.67it/s]Activation collect:  12%|████▊                                   | 15/125 [00:09<01:07,  1.64it/s]Activation collect:  13%|█████                                   | 16/125 [00:09<01:07,  1.62it/s]Activation collect:  14%|█████▍                                  | 17/125 [00:10<01:04,  1.69it/s]Activation collect:  14%|█████▊                                  | 18/125 [00:10<01:02,  1.72it/s]Activation collect:  15%|██████                                  | 19/125 [00:11<01:02,  1.68it/s]Activation collect:  16%|██████▍                                 | 20/125 [00:12<01:02,  1.69it/s]Activation collect:  17%|██████▋                                 | 21/125 [00:12<01:03,  1.64it/s]Activation collect:  18%|███████                                 | 22/125 [00:13<01:01,  1.66it/s]Activation collect:  18%|███████▎                                | 23/125 [00:14<01:05,  1.56it/s]Activation collect:  19%|███████▋                                | 24/125 [00:14<01:03,  1.60it/s]Activation collect:  20%|████████                                | 25/125 [00:15<01:02,  1.61it/s]Activation collect:  21%|████████▎                               | 26/125 [00:15<01:00,  1.63it/s]Activation collect:  22%|████████▋                               | 27/125 [00:16<00:59,  1.64it/s]Activation collect:  22%|████████▉                               | 28/125 [00:17<00:59,  1.62it/s]Activation collect:  23%|█████████▎                              | 29/125 [00:17<01:01,  1.57it/s]Activation collect:  24%|█████████▌                              | 30/125 [00:18<01:02,  1.52it/s]Activation collect:  25%|█████████▉                              | 31/125 [00:19<01:00,  1.55it/s]Activation collect:  26%|██████████▏                             | 32/125 [00:19<01:00,  1.54it/s]Activation collect:  26%|██████████▌                             | 33/125 [00:20<00:58,  1.57it/s]Activation collect:  27%|██████████▉                             | 34/125 [00:21<00:57,  1.59it/s]Activation collect:  28%|███████████▏                            | 35/125 [00:21<00:57,  1.57it/s]Activation collect:  29%|███████████▌                            | 36/125 [00:22<00:56,  1.57it/s]Activation collect:  30%|███████████▊                            | 37/125 [00:23<00:56,  1.55it/s]Activation collect:  30%|████████████▏                           | 38/125 [00:23<00:53,  1.63it/s]Activation collect:  31%|████████████▍                           | 39/125 [00:24<00:52,  1.62it/s]Activation collect:  32%|████████████▊                           | 40/125 [00:24<00:53,  1.58it/s]Activation collect:  33%|█████████████                           | 41/125 [00:25<00:52,  1.61it/s]Activation collect:  34%|█████████████▍                          | 42/125 [00:26<00:51,  1.61it/s]Activation collect:  34%|█████████████▊                          | 43/125 [00:26<00:49,  1.64it/s]Activation collect:  35%|██████████████                          | 44/125 [00:27<00:48,  1.66it/s]Activation collect:  36%|██████████████▍                         | 45/125 [00:27<00:50,  1.57it/s]Activation collect:  37%|██████████████▋                         | 46/125 [00:28<00:49,  1.61it/s]Activation collect:  38%|███████████████                         | 47/125 [00:29<00:48,  1.60it/s]Activation collect:  38%|███████████████▎                        | 48/125 [00:29<00:46,  1.65it/s]Activation collect:  39%|███████████████▋                        | 49/125 [00:30<00:47,  1.59it/s]Activation collect:  40%|████████████████                        | 50/125 [00:31<00:46,  1.63it/s]Activation collect:  41%|████████████████▎                       | 51/125 [00:31<00:46,  1.60it/s]Activation collect:  42%|████████████████▋                       | 52/125 [00:32<00:45,  1.60it/s]Activation collect:  42%|████████████████▉                       | 53/125 [00:32<00:45,  1.59it/s]Activation collect:  43%|█████████████████▎                      | 54/125 [00:33<00:43,  1.63it/s]Activation collect:  44%|█████████████████▌                      | 55/125 [00:34<00:43,  1.61it/s]Activation collect:  45%|█████████████████▉                      | 56/125 [00:34<00:44,  1.54it/s]Activation collect:  46%|██████████████████▏                     | 57/125 [00:35<00:42,  1.58it/s]Activation collect:  46%|██████████████████▌                     | 58/125 [00:36<00:43,  1.56it/s]Activation collect:  47%|██████████████████▉                     | 59/125 [00:36<00:41,  1.59it/s]Activation collect:  48%|███████████████████▏                    | 60/125 [00:37<00:40,  1.62it/s]Activation collect:  49%|███████████████████▌                    | 61/125 [00:37<00:39,  1.63it/s]Activation collect:  50%|███████████████████▊                    | 62/125 [00:38<00:39,  1.59it/s]Activation collect:  50%|████████████████████▏                   | 63/125 [00:39<00:39,  1.59it/s]Activation collect:  51%|████████████████████▍                   | 64/125 [00:39<00:38,  1.59it/s]Activation collect:  52%|████████████████████▊                   | 65/125 [00:40<00:37,  1.60it/s]Activation collect:  53%|█████████████████████                   | 66/125 [00:41<00:36,  1.62it/s]Activation collect:  54%|█████████████████████▍                  | 67/125 [00:41<00:36,  1.61it/s]Activation collect:  54%|█████████████████████▊                  | 68/125 [00:42<00:35,  1.63it/s]Activation collect:  55%|██████████████████████                  | 69/125 [00:42<00:32,  1.71it/s]Activation collect:  56%|██████████████████████▍                 | 70/125 [00:43<00:34,  1.61it/s]Activation collect:  57%|██████████████████████▋                 | 71/125 [00:44<00:33,  1.61it/s]Activation collect:  58%|███████████████████████                 | 72/125 [00:44<00:32,  1.63it/s]Activation collect:  58%|███████████████████████▎                | 73/125 [00:45<00:31,  1.65it/s]Activation collect:  59%|███████████████████████▋                | 74/125 [00:45<00:30,  1.67it/s]Activation collect:  60%|████████████████████████                | 75/125 [00:46<00:29,  1.67it/s]Activation collect:  61%|████████████████████████▎               | 76/125 [00:47<00:28,  1.72it/s]Activation collect:  62%|████████████████████████▋               | 77/125 [00:47<00:28,  1.71it/s]Activation collect:  62%|████████████████████████▉               | 78/125 [00:48<00:28,  1.67it/s]Activation collect:  63%|█████████████████████████▎              | 79/125 [00:48<00:26,  1.71it/s]Activation collect:  64%|█████████████████████████▌              | 80/125 [00:49<00:27,  1.63it/s]Activation collect:  65%|█████████████████████████▉              | 81/125 [00:50<00:26,  1.65it/s]Activation collect:  66%|██████████████████████████▏             | 82/125 [00:50<00:25,  1.69it/s]Activation collect:  66%|██████████████████████████▌             | 83/125 [00:51<00:25,  1.65it/s]Activation collect:  67%|██████████████████████████▉             | 84/125 [00:51<00:24,  1.64it/s]Activation collect:  68%|███████████████████████████▏            | 85/125 [00:52<00:24,  1.62it/s]Activation collect:  69%|███████████████████████████▌            | 86/125 [00:53<00:24,  1.60it/s]Activation collect:  70%|███████████████████████████▊            | 87/125 [00:53<00:22,  1.67it/s]Activation collect:  70%|████████████████████████████▏           | 88/125 [00:54<00:22,  1.67it/s]Activation collect:  71%|████████████████████████████▍           | 89/125 [00:54<00:22,  1.62it/s]Activation collect:  72%|████████████████████████████▊           | 90/125 [00:55<00:21,  1.64it/s]Activation collect:  73%|█████████████████████████████           | 91/125 [00:56<00:20,  1.70it/s]Activation collect:  74%|█████████████████████████████▍          | 92/125 [00:56<00:19,  1.72it/s]Activation collect:  74%|█████████████████████████████▊          | 93/125 [00:57<00:19,  1.66it/s]Activation collect:  75%|██████████████████████████████          | 94/125 [00:57<00:18,  1.66it/s]Activation collect:  76%|██████████████████████████████▍         | 95/125 [00:58<00:18,  1.64it/s]Activation collect:  77%|██████████████████████████████▋         | 96/125 [00:59<00:17,  1.62it/s]Activation collect:  78%|███████████████████████████████         | 97/125 [00:59<00:17,  1.60it/s]Activation collect:  78%|███████████████████████████████▎        | 98/125 [01:00<00:17,  1.57it/s]Activation collect:  79%|███████████████████████████████▋        | 99/125 [01:01<00:16,  1.61it/s]Activation collect:  80%|███████████████████████████████▏       | 100/125 [01:01<00:15,  1.62it/s]Activation collect:  81%|███████████████████████████████▌       | 101/125 [01:02<00:14,  1.63it/s]Activation collect:  82%|███████████████████████████████▊       | 102/125 [01:02<00:14,  1.64it/s]Activation collect:  82%|████████████████████████████████▏      | 103/125 [01:03<00:13,  1.60it/s]Activation collect:  83%|████████████████████████████████▍      | 104/125 [01:04<00:13,  1.59it/s]Activation collect:  84%|████████████████████████████████▊      | 105/125 [01:04<00:12,  1.59it/s]Activation collect:  85%|█████████████████████████████████      | 106/125 [01:05<00:11,  1.62it/s]Activation collect:  86%|█████████████████████████████████▍     | 107/125 [01:06<00:11,  1.60it/s]Activation collect:  86%|█████████████████████████████████▋     | 108/125 [01:06<00:10,  1.66it/s]Activation collect:  87%|██████████████████████████████████     | 109/125 [01:07<00:09,  1.62it/s]Activation collect:  88%|██████████████████████████████████▎    | 110/125 [01:07<00:09,  1.64it/s]Activation collect:  89%|██████████████████████████████████▋    | 111/125 [01:08<00:08,  1.62it/s]Activation collect:  90%|██████████████████████████████████▉    | 112/125 [01:09<00:07,  1.65it/s]Activation collect:  90%|███████████████████████████████████▎   | 113/125 [01:09<00:07,  1.62it/s]Activation collect:  91%|███████████████████████████████████▌   | 114/125 [01:10<00:06,  1.58it/s]Activation collect:  92%|███████████████████████████████████▉   | 115/125 [01:10<00:06,  1.60it/s]Activation collect:  93%|████████████████████████████████████▏  | 116/125 [01:11<00:05,  1.61it/s]Activation collect:  94%|████████████████████████████████████▌  | 117/125 [01:12<00:04,  1.63it/s]Activation collect:  94%|████████████████████████████████████▊  | 118/125 [01:12<00:04,  1.67it/s]Activation collect:  95%|█████████████████████████████████████▏ | 119/125 [01:13<00:03,  1.57it/s]Activation collect:  96%|█████████████████████████████████████▍ | 120/125 [01:14<00:03,  1.57it/s]Activation collect:  97%|█████████████████████████████████████▊ | 121/125 [01:14<00:02,  1.59it/s]Activation collect:  98%|██████████████████████████████████████ | 122/125 [01:15<00:01,  1.62it/s]Activation collect:  98%|██████████████████████████████████████▍| 123/125 [01:15<00:01,  1.64it/s]Activation collect:  99%|██████████████████████████████████████▋| 124/125 [01:16<00:00,  1.66it/s]Activation collect: 100%|███████████████████████████████████████| 125/125 [01:17<00:00,  1.66it/s]Activation collect: 100%|███████████████████████████████████████| 125/125 [01:17<00:00,  1.62it/s]

============================================================
ACTIVATION COLLECT SUMMARY
============================================================
Processed samples : 500 / 500
 Layer        Norm         Std
--------------------------------
     0      221.83    0.002831
     1       25.53    0.002211
     2       60.46    0.004205
     3       55.04    0.009722
     4      392.69    0.005613
     5       90.15    0.002981
     6       67.91    0.008746
     7      252.77    0.011020
     8      699.87    0.023070
     9      916.42    0.028953
    10      348.82    0.035634
    11      297.54    0.056458
    12      158.31    0.038252
    13      365.70    0.052329
    14      198.33    0.054953
    15      902.09    0.104259
    16      532.69    0.101662
    17     1321.78    0.160838
    18      280.47    0.158306
    19      557.38    0.206620
    20      811.92    0.310247
    21     1520.38    0.470758
    22     1488.56    0.570800
    23     1700.50    0.822040
    24     1234.70    1.329737
    25     3831.22    1.840865
    26     1456.65    2.548064
    27     4683.88    3.244885
    28     2312.39    3.408167
    29     4644.40    4.124946
    30     4111.65    3.974534
    31     2211.00    4.003930
    32     2501.34    4.165530
    33     2724.41    3.465506
    34     3143.42    4.059559
    35     3966.98    5.598209
    36     5259.08    5.842652
    37     4293.27    4.967195
    38     3547.13    4.971136
    39     4987.28    7.286190
    40     3778.94    5.918331
    41     3892.26    5.224918
    42     2997.77    5.706922
    43     3907.64    7.301332
    44     3411.58    5.998042
    45     4234.34    6.768499
    46     4543.38    7.427077
    47     1954.43    2.972178
    48     4315.81    6.179204
    49     3656.11    5.552774
    50     3834.26    5.954250
    51     2400.55    3.935899
    52     9157.52   10.284534
    53     6753.94   11.017039
    54     5313.06    7.601063
    55    13163.59   16.460077
    56    12640.25   17.947515
    57    17478.92   25.290340
    58    20913.98   30.800161
    59    13097.24   26.344273
    60    11798.53   18.904934
    61    41054.53   12.413594
============================================================

Results saved to: /home/ubuntu/CoTLab/outputs/2026-02-26/18-28-03_activation_compare_medgemma_27b_text_it_pubmedqa_json_pubmedqa/results.json

Metrics:
  num_samples: 500
  pooling: last_token
  layer_stride: 1
  activation_norms: {0: 221.8338, 1: 25.5324, 2: 60.4564, 3: 55.0356, 4: 392.6927, 5: 90.1535, 6: 67.9135, 7: 252.7688, 8: 699.8705, 9: 916.4162, 10: 348.8218, 11: 297.5356, 12: 158.3084, 13: 365.6956, 14: 198.3274, 15: 902.0859, 16: 532.694, 17: 1321.7817, 18: 280.4713, 19: 557.3792, 20: 811.9188, 21: 1520.3816, 22: 1488.5596, 23: 1700.4962, 24: 1234.6964, 25: 3831.2227, 26: 1456.6493, 27: 4683.8804, 28: 2312.3853, 29: 4644.3975, 30: 4111.6528, 31: 2210.998, 32: 2501.3413, 33: 2724.4138, 34: 3143.4197, 35: 3966.9753, 36: 5259.0815, 37: 4293.2725, 38: 3547.1326, 39: 4987.2803, 40: 3778.9421, 41: 3892.2607, 42: 2997.7651, 43: 3907.6387, 44: 3411.5781, 45: 4234.3413, 46: 4543.377, 47: 1954.4316, 48: 4315.8091, 49: 3656.1072, 50: 3834.2551, 51: 2400.5486, 52: 9157.5156, 53: 6753.9438, 54: 5313.0596, 55: 13163.5918, 56: 12640.2549, 57: 17478.9219, 58: 20913.9824, 59: 13097.2373, 60: 11798.5303, 61: 41054.5312}
  activation_std: {0: 0.002831, 1: 0.002211, 2: 0.004205, 3: 0.009722, 4: 0.005613, 5: 0.002981, 6: 0.008746, 7: 0.01102, 8: 0.02307, 9: 0.028953, 10: 0.035634, 11: 0.056458, 12: 0.038252, 13: 0.052329, 14: 0.054953, 15: 0.104259, 16: 0.101662, 17: 0.160838, 18: 0.158306, 19: 0.20662, 20: 0.310247, 21: 0.470758, 22: 0.5708, 23: 0.82204, 24: 1.329737, 25: 1.840865, 26: 2.548064, 27: 3.244885, 28: 3.408167, 29: 4.124946, 30: 3.974534, 31: 4.00393, 32: 4.16553, 33: 3.465506, 34: 4.059559, 35: 5.598209, 36: 5.842652, 37: 4.967195, 38: 4.971136, 39: 7.28619, 40: 5.918331, 41: 5.224918, 42: 5.706922, 43: 7.301332, 44: 5.998042, 45: 6.768499, 46: 7.427077, 47: 2.972178, 48: 6.179204, 49: 5.552774, 50: 5.95425, 51: 3.935899, 52: 10.284534, 53: 11.017039, 54: 7.601063, 55: 16.460077, 56: 17.947515, 57: 25.29034, 58: 30.800161, 59: 26.344273, 60: 18.904934, 61: 12.413594}

Experiment documentation updated: /home/ubuntu/CoTLab/outputs/2026-02-26/18-28-03_activation_compare_medgemma_27b_text_it_pubmedqa_json_pubmedqa/EXPERIMENT.md

Experiment complete.
