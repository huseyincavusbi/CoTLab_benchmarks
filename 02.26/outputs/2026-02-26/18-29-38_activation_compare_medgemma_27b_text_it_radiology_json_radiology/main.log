============================================================
Configuration:
============================================================
backend:
  _target_: cotlab.backends.TransformersBackend
  device: cuda
  dtype: bfloat16
  enable_hooks: true
  trust_remote_code: true
model:
  name: google/medgemma-27b-text-it
  variant: 27b-text
  max_new_tokens: 512
  temperature: 0.7
  top_p: 0.9
  safe_name: medgemma_27b_text_it
prompt:
  _target_: cotlab.prompts.RadiologyPromptStrategy
  name: radiology
  contrarian: false
  few_shot: true
  answer_first: false
  output_format: json
dataset:
  _target_: cotlab.datasets.RadiologyDataset
  name: radiology
  path: data/radiology.json
experiment:
  _target_: cotlab.experiments.ActivationCompareExperiment
  name: activation_compare
  description: Collect mean layer activations for representational comparison
  layer_stride: 1
  num_samples: null
  pooling: last_token
  max_input_tokens: 1024
  seed: 42
  answer_cue: '


    Answer:'
  batch_size: 4
seed: 42
verbose: true
dry_run: false

============================================================
Created experiment documentation: /home/ubuntu/CoTLab/outputs/2026-02-26/18-29-38_activation_compare_medgemma_27b_text_it_radiology_json_radiology/EXPERIMENT.md
Loading backend: cotlab.backends.TransformersBackend
Loading model: google/medgemma-27b-text-it
  Device map: cuda
  Dtype: torch.bfloat16
  Cache: ~/.cache/huggingface (HF default)
Loading checkpoint shards:   0%|                                           | 0/11 [00:00<?, ?it/s]Loading checkpoint shards:   9%|███▏                               | 1/11 [00:00<00:07,  1.42it/s]Loading checkpoint shards:  18%|██████▎                            | 2/11 [00:01<00:06,  1.40it/s]Loading checkpoint shards:  27%|█████████▌                         | 3/11 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  36%|████████████▋                      | 4/11 [00:02<00:05,  1.39it/s]Loading checkpoint shards:  45%|███████████████▉                   | 5/11 [00:03<00:04,  1.41it/s]Loading checkpoint shards:  55%|███████████████████                | 6/11 [00:04<00:03,  1.42it/s]Loading checkpoint shards:  64%|██████████████████████▎            | 7/11 [00:04<00:02,  1.40it/s]Loading checkpoint shards:  73%|█████████████████████████▍         | 8/11 [00:05<00:02,  1.40it/s]Loading checkpoint shards:  82%|████████████████████████████▋      | 9/11 [00:06<00:01,  1.41it/s]Loading checkpoint shards:  91%|██████████████████████████████▉   | 10/11 [00:07<00:00,  1.43it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.43it/s]
  Resolved device: cuda:0
Creating prompt strategy: radiology
Loading dataset: radiology
Creating experiment: activation_compare
============================================================
Running experiment: activation_compare
============================================================
Model : google/medgemma-27b-text-it
Layers (62): [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61]
Pooling: last_token
Batch size: 4
Samples: 100

Activation collect:   0%|                                                  | 0/25 [00:00<?, ?it/s]Activation collect:   4%|█▋                                        | 1/25 [00:00<00:21,  1.10it/s]Activation collect:   8%|███▎                                      | 2/25 [00:01<00:15,  1.52it/s]Activation collect:  12%|█████                                     | 3/25 [00:01<00:12,  1.78it/s]Activation collect:  16%|██████▋                                   | 4/25 [00:02<00:10,  1.97it/s]Activation collect:  20%|████████▍                                 | 5/25 [00:02<00:09,  2.07it/s]Activation collect:  24%|██████████                                | 6/25 [00:03<00:08,  2.13it/s]Activation collect:  28%|███████████▊                              | 7/25 [00:03<00:08,  2.18it/s]Activation collect:  32%|█████████████▍                            | 8/25 [00:04<00:07,  2.16it/s]Activation collect:  36%|███████████████                           | 9/25 [00:04<00:07,  2.21it/s]Activation collect:  40%|████████████████▍                        | 10/25 [00:04<00:06,  2.22it/s]Activation collect:  44%|██████████████████                       | 11/25 [00:05<00:06,  2.15it/s]Activation collect:  48%|███████████████████▋                     | 12/25 [00:05<00:05,  2.21it/s]Activation collect:  52%|█████████████████████▎                   | 13/25 [00:06<00:05,  2.09it/s]Activation collect:  56%|██████████████████████▉                  | 14/25 [00:06<00:05,  2.06it/s]Activation collect:  60%|████████████████████████▌                | 15/25 [00:07<00:04,  2.13it/s]Activation collect:  64%|██████████████████████████▏              | 16/25 [00:07<00:04,  2.12it/s]Activation collect:  68%|███████████████████████████▉             | 17/25 [00:08<00:03,  2.18it/s]Activation collect:  72%|█████████████████████████████▌           | 18/25 [00:08<00:03,  2.10it/s]Activation collect:  76%|███████████████████████████████▏         | 19/25 [00:09<00:02,  2.12it/s]Activation collect:  80%|████████████████████████████████▊        | 20/25 [00:09<00:02,  2.18it/s]Activation collect:  84%|██████████████████████████████████▍      | 21/25 [00:10<00:01,  2.20it/s]Activation collect:  88%|████████████████████████████████████     | 22/25 [00:10<00:01,  1.98it/s]Activation collect:  92%|█████████████████████████████████████▋   | 23/25 [00:11<00:00,  2.06it/s]Activation collect:  96%|███████████████████████████████████████▎ | 24/25 [00:11<00:00,  2.12it/s]Activation collect: 100%|█████████████████████████████████████████| 25/25 [00:12<00:00,  2.17it/s]Activation collect: 100%|█████████████████████████████████████████| 25/25 [00:12<00:00,  2.08it/s]

============================================================
ACTIVATION COLLECT SUMMARY
============================================================
Processed samples : 100 / 100
 Layer        Norm         Std
--------------------------------
     0      225.09    0.002895
     1       26.50    0.002711
     2       57.72    0.003666
     3       56.42    0.008555
     4      396.83    0.005133
     5       89.63    0.003280
     6       66.14    0.011500
     7      219.56    0.016065
     8      760.14    0.028297
     9      757.25    0.043930
    10      366.43    0.051636
    11      359.62    0.072580
    12      158.85    0.060314
    13      452.07    0.067729
    14      303.17    0.080479
    15      842.91    0.123529
    16      782.27    0.135533
    17     1358.64    0.220552
    18      234.65    0.233802
    19      331.38    0.282050
    20      494.14    0.419445
    21     1186.80    0.490922
    22      786.42    0.626818
    23      959.85    0.845392
    24     2938.88    1.205902
    25     1594.70    1.840010
    26     1503.09    2.252680
    27     6993.06    2.487252
    28     4586.81    2.676520
    29     5688.39    2.765786
    30     5953.88    2.601294
    31     2452.37    2.519135
    32     2327.07    2.466705
    33     2661.81    2.386914
    34     3557.81    2.704957
    35     3529.97    3.691401
    36     4805.95    4.368117
    37     3876.60    3.761679
    38     3491.32    4.081671
    39     4783.31    6.244920
    40     4708.86    5.437040
    41     3990.42    4.485096
    42     3329.81    5.951858
    43     4424.06    7.522135
    44     4450.12    7.723064
    45     4705.20    8.014783
    46     5673.52    9.699800
    47     2345.80    4.077605
    48     4621.53    7.586985
    49     4348.99    7.276510
    50     3606.92    6.707305
    51     2497.69    4.661885
    52     8244.08   12.378921
    53     6723.14   13.192141
    54     5168.07    9.152438
    55    11655.36   17.795965
    56    10859.00   18.954334
    57    16987.16   32.613853
    58    20477.33   40.919182
    59    13116.15   33.030384
    60    10391.82   23.921875
    61    28629.24   15.716264
============================================================

Results saved to: /home/ubuntu/CoTLab/outputs/2026-02-26/18-29-38_activation_compare_medgemma_27b_text_it_radiology_json_radiology/results.json

Metrics:
  num_samples: 100
  pooling: last_token
  layer_stride: 1
  activation_norms: {0: 225.0859, 1: 26.5045, 2: 57.7213, 3: 56.4238, 4: 396.828, 5: 89.6335, 6: 66.1444, 7: 219.5573, 8: 760.144, 9: 757.2498, 10: 366.4254, 11: 359.6165, 12: 158.849, 13: 452.0739, 14: 303.1702, 15: 842.9147, 16: 782.2743, 17: 1358.6407, 18: 234.6549, 19: 331.3759, 20: 494.1383, 21: 1186.801, 22: 786.4156, 23: 959.845, 24: 2938.8752, 25: 1594.6996, 26: 1503.0941, 27: 6993.0625, 28: 4586.8135, 29: 5688.3887, 30: 5953.8774, 31: 2452.3706, 32: 2327.0745, 33: 2661.8052, 34: 3557.8098, 35: 3529.9729, 36: 4805.9487, 37: 3876.5955, 38: 3491.3213, 39: 4783.3052, 40: 4708.8623, 41: 3990.4246, 42: 3329.8103, 43: 4424.0557, 44: 4450.1182, 45: 4705.2041, 46: 5673.5215, 47: 2345.8044, 48: 4621.5259, 49: 4348.9941, 50: 3606.9229, 51: 2497.689, 52: 8244.0801, 53: 6723.1426, 54: 5168.0654, 55: 11655.3604, 56: 10859.0, 57: 16987.1621, 58: 20477.3301, 59: 13116.1523, 60: 10391.8164, 61: 28629.2383}
  activation_std: {0: 0.002895, 1: 0.002711, 2: 0.003666, 3: 0.008555, 4: 0.005133, 5: 0.00328, 6: 0.0115, 7: 0.016065, 8: 0.028297, 9: 0.04393, 10: 0.051636, 11: 0.07258, 12: 0.060314, 13: 0.067729, 14: 0.080479, 15: 0.123529, 16: 0.135533, 17: 0.220552, 18: 0.233802, 19: 0.28205, 20: 0.419445, 21: 0.490922, 22: 0.626818, 23: 0.845392, 24: 1.205902, 25: 1.84001, 26: 2.25268, 27: 2.487252, 28: 2.67652, 29: 2.765786, 30: 2.601294, 31: 2.519135, 32: 2.466705, 33: 2.386914, 34: 2.704957, 35: 3.691401, 36: 4.368117, 37: 3.761679, 38: 4.081671, 39: 6.24492, 40: 5.43704, 41: 4.485096, 42: 5.951858, 43: 7.522135, 44: 7.723064, 45: 8.014783, 46: 9.6998, 47: 4.077605, 48: 7.586985, 49: 7.27651, 50: 6.707305, 51: 4.661885, 52: 12.378921, 53: 13.192141, 54: 9.152438, 55: 17.795965, 56: 18.954334, 57: 32.613853, 58: 40.919182, 59: 33.030384, 60: 23.921875, 61: 15.716264}

Experiment documentation updated: /home/ubuntu/CoTLab/outputs/2026-02-26/18-29-38_activation_compare_medgemma_27b_text_it_radiology_json_radiology/EXPERIMENT.md

Experiment complete.
