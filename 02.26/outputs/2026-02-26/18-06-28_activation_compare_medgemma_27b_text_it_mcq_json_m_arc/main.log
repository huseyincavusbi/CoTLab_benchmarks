============================================================
Configuration:
============================================================
backend:
  _target_: cotlab.backends.TransformersBackend
  device: cuda
  dtype: bfloat16
  enable_hooks: true
  trust_remote_code: true
model:
  name: google/medgemma-27b-text-it
  variant: 27b-text
  max_new_tokens: 512
  temperature: 0.7
  top_p: 0.9
  safe_name: medgemma_27b_text_it
prompt:
  _target_: cotlab.prompts.mcq.MCQPromptStrategy
  name: mcq
  few_shot: true
  output_format: json
  answer_first: false
  contrarian: false
dataset:
  _target_: cotlab.datasets.loaders.MARCDataset
  name: m_arc
  filename: m_arc/test-00000-of-00001.parquet
  split: test
experiment:
  _target_: cotlab.experiments.ActivationCompareExperiment
  name: activation_compare
  description: Collect mean layer activations for representational comparison
  layer_stride: 1
  num_samples: null
  pooling: last_token
  max_input_tokens: 1024
  seed: 42
  answer_cue: '


    Answer:'
  batch_size: 4
seed: 42
verbose: true
dry_run: false

============================================================
Created experiment documentation: /home/ubuntu/CoTLab/outputs/2026-02-26/18-06-28_activation_compare_medgemma_27b_text_it_mcq_json_m_arc/EXPERIMENT.md
Loading backend: cotlab.backends.TransformersBackend
Loading model: google/medgemma-27b-text-it
  Device map: cuda
  Dtype: torch.bfloat16
  Cache: ~/.cache/huggingface (HF default)
Loading checkpoint shards:   0%|                                           | 0/11 [00:00<?, ?it/s]Loading checkpoint shards:   9%|███▏                               | 1/11 [00:00<00:07,  1.43it/s]Loading checkpoint shards:  18%|██████▎                            | 2/11 [00:01<00:06,  1.41it/s]Loading checkpoint shards:  27%|█████████▌                         | 3/11 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  36%|████████████▋                      | 4/11 [00:02<00:05,  1.40it/s]Loading checkpoint shards:  45%|███████████████▉                   | 5/11 [00:03<00:04,  1.42it/s]Loading checkpoint shards:  55%|███████████████████                | 6/11 [00:04<00:03,  1.43it/s]Loading checkpoint shards:  64%|██████████████████████▎            | 7/11 [00:04<00:02,  1.41it/s]Loading checkpoint shards:  73%|█████████████████████████▍         | 8/11 [00:05<00:02,  1.40it/s]Loading checkpoint shards:  82%|████████████████████████████▋      | 9/11 [00:06<00:01,  1.42it/s]Loading checkpoint shards:  91%|██████████████████████████████▉   | 10/11 [00:07<00:00,  1.44it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████████████████████████████| 11/11 [00:07<00:00,  1.43it/s]
  Resolved device: cuda:0
Creating prompt strategy: mcq
Loading dataset: m_arc
m_arc/test-00000-of-00001.parquet:   0%|                              | 0.00/49.3k [00:00<?, ?B/s]m_arc/test-00000-of-00001.parquet:   0%|                              | 0.00/49.3k [00:00<?, ?B/s]m_arc/test-00000-of-00001.parquet:   0%|                              | 0.00/49.3k [00:00<?, ?B/s]m_arc/test-00000-of-00001.parquet:   0%|                              | 0.00/49.3k [00:00<?, ?B/s]m_arc/test-00000-of-00001.parquet:   0%|                              | 0.00/49.3k [00:00<?, ?B/s]m_arc/test-00000-of-00001.parquet: 100%|██████████████████████| 49.3k/49.3k [00:00<00:00, 137kB/s]
Creating experiment: activation_compare
============================================================
Running experiment: activation_compare
============================================================
Model : google/medgemma-27b-text-it
Layers (62): [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61]
Pooling: last_token
Batch size: 4
Samples: 100

Activation collect:   0%|                                                  | 0/25 [00:00<?, ?it/s]Activation collect:   4%|█▋                                        | 1/25 [00:00<00:22,  1.05it/s]Activation collect:   8%|███▎                                      | 2/25 [00:01<00:16,  1.41it/s]Activation collect:  12%|█████                                     | 3/25 [00:02<00:14,  1.52it/s]Activation collect:  16%|██████▋                                   | 4/25 [00:02<00:13,  1.56it/s]Activation collect:  20%|████████▍                                 | 5/25 [00:03<00:12,  1.61it/s]Activation collect:  24%|██████████                                | 6/25 [00:03<00:11,  1.70it/s]Activation collect:  28%|███████████▊                              | 7/25 [00:04<00:10,  1.69it/s]Activation collect:  32%|█████████████▍                            | 8/25 [00:05<00:10,  1.68it/s]Activation collect:  36%|███████████████                           | 9/25 [00:05<00:09,  1.70it/s]Activation collect:  40%|████████████████▍                        | 10/25 [00:06<00:09,  1.59it/s]Activation collect:  44%|██████████████████                       | 11/25 [00:07<00:09,  1.44it/s]Activation collect:  48%|███████████████████▋                     | 12/25 [00:07<00:08,  1.45it/s]Activation collect:  52%|█████████████████████▎                   | 13/25 [00:08<00:08,  1.38it/s]Activation collect:  56%|██████████████████████▉                  | 14/25 [00:09<00:07,  1.40it/s]Activation collect:  60%|████████████████████████▌                | 15/25 [00:09<00:06,  1.44it/s]Activation collect:  64%|██████████████████████████▏              | 16/25 [00:10<00:05,  1.51it/s]Activation collect:  68%|███████████████████████████▉             | 17/25 [00:11<00:05,  1.42it/s]Activation collect:  72%|█████████████████████████████▌           | 18/25 [00:12<00:05,  1.36it/s]Activation collect:  76%|███████████████████████████████▏         | 19/25 [00:12<00:04,  1.46it/s]Activation collect:  80%|████████████████████████████████▊        | 20/25 [00:13<00:03,  1.52it/s]Activation collect:  84%|██████████████████████████████████▍      | 21/25 [00:13<00:02,  1.52it/s]Activation collect:  88%|████████████████████████████████████     | 22/25 [00:14<00:01,  1.56it/s]Activation collect:  92%|█████████████████████████████████████▋   | 23/25 [00:15<00:01,  1.56it/s]Activation collect:  96%|███████████████████████████████████████▎ | 24/25 [00:15<00:00,  1.53it/s]Activation collect: 100%|█████████████████████████████████████████| 25/25 [00:16<00:00,  1.45it/s]Activation collect: 100%|█████████████████████████████████████████| 25/25 [00:16<00:00,  1.50it/s]

============================================================
ACTIVATION COLLECT SUMMARY
============================================================
Processed samples : 100 / 100
 Layer        Norm         Std
--------------------------------
     0      197.33    0.408836
     1       26.74    0.063106
     2       57.31    0.092629
     3       51.39    0.158172
     4      386.92    0.132134
     5       89.53    0.131967
     6       64.20    0.173939
     7      246.80    0.189255
     8      735.12    0.402810
     9      848.46    0.594278
    10      361.45    0.466875
    11      261.89    0.459062
    12      153.04    0.521817
    13      305.43    0.695935
    14      287.98    0.784928
    15      658.24    0.884397
    16      554.68    1.085595
    17     1332.97    1.295693
    18      425.81    1.479429
    19      399.56    1.790564
    20      468.98    2.404325
    21     1206.87    2.932026
    22      876.46    3.341236
    23      934.67    4.432502
    24      850.04    5.767678
    25     2504.36    6.594056
    26     1636.76    8.326408
    27     3700.47    9.512839
    28     3593.27    9.873521
    29     4322.31   12.092219
    30     5182.77   12.451216
    31     2375.18   11.774785
    32     2375.08   12.453242
    33     2625.33   11.196755
    34     3827.56   14.076180
    35     2951.71   18.665010
    36     4906.42   23.634508
    37     3318.64   19.132292
    38     3087.68   19.790190
    39     3996.79   24.700695
    40     3540.07   22.271299
    41     3361.68   22.374865
    42     2616.67   22.116737
    43     3334.72   24.147451
    44     3102.65   23.245396
    45     3778.73   28.038376
    46     4618.54   32.981190
    47     1918.94   19.698895
    48     3597.23   29.498030
    49     3224.14   28.580677
    50     3445.60   25.029320
    51     2288.21   14.352161
    52     6856.66   40.304089
    53     5219.71   30.007458
    54     4802.58   27.709700
    55    11169.41   70.590317
    56    10555.34   62.200882
    57    15208.52   59.848110
    58    19972.71   81.991188
    59    10547.26   70.791473
    60     9934.89   52.197487
    61    36744.02   43.953739
============================================================

Results saved to: /home/ubuntu/CoTLab/outputs/2026-02-26/18-06-28_activation_compare_medgemma_27b_text_it_mcq_json_m_arc/results.json

Metrics:
  num_samples: 100
  pooling: last_token
  layer_stride: 1
  activation_norms: {0: 197.3281, 1: 26.739, 2: 57.3105, 3: 51.3852, 4: 386.9154, 5: 89.5332, 6: 64.2013, 7: 246.8027, 8: 735.1215, 9: 848.4612, 10: 361.4481, 11: 261.892, 12: 153.0354, 13: 305.4277, 14: 287.9794, 15: 658.2435, 16: 554.6824, 17: 1332.9667, 18: 425.814, 19: 399.5609, 20: 468.9774, 21: 1206.8673, 22: 876.463, 23: 934.6662, 24: 850.0434, 25: 2504.3552, 26: 1636.7573, 27: 3700.4731, 28: 3593.2732, 29: 4322.3101, 30: 5182.7729, 31: 2375.1814, 32: 2375.0798, 33: 2625.3315, 34: 3827.5564, 35: 2951.7126, 36: 4906.4194, 37: 3318.6372, 38: 3087.677, 39: 3996.7861, 40: 3540.0742, 41: 3361.677, 42: 2616.6736, 43: 3334.7151, 44: 3102.6492, 45: 3778.7251, 46: 4618.542, 47: 1918.9365, 48: 3597.2273, 49: 3224.1353, 50: 3445.5981, 51: 2288.2136, 52: 6856.6646, 53: 5219.7065, 54: 4802.5845, 55: 11169.4111, 56: 10555.3408, 57: 15208.5234, 58: 19972.7148, 59: 10547.2627, 60: 9934.8896, 61: 36744.0234}
  activation_std: {0: 0.408836, 1: 0.063106, 2: 0.092629, 3: 0.158172, 4: 0.132134, 5: 0.131967, 6: 0.173939, 7: 0.189255, 8: 0.40281, 9: 0.594278, 10: 0.466875, 11: 0.459062, 12: 0.521817, 13: 0.695935, 14: 0.784928, 15: 0.884397, 16: 1.085595, 17: 1.295693, 18: 1.479429, 19: 1.790564, 20: 2.404325, 21: 2.932026, 22: 3.341236, 23: 4.432502, 24: 5.767678, 25: 6.594056, 26: 8.326408, 27: 9.512839, 28: 9.873521, 29: 12.092219, 30: 12.451216, 31: 11.774785, 32: 12.453242, 33: 11.196755, 34: 14.07618, 35: 18.66501, 36: 23.634508, 37: 19.132292, 38: 19.79019, 39: 24.700695, 40: 22.271299, 41: 22.374865, 42: 22.116737, 43: 24.147451, 44: 23.245396, 45: 28.038376, 46: 32.98119, 47: 19.698895, 48: 29.49803, 49: 28.580677, 50: 25.02932, 51: 14.352161, 52: 40.304089, 53: 30.007458, 54: 27.7097, 55: 70.590317, 56: 62.200882, 57: 59.84811, 58: 81.991188, 59: 70.791473, 60: 52.197487, 61: 43.953739}

Experiment documentation updated: /home/ubuntu/CoTLab/outputs/2026-02-26/18-06-28_activation_compare_medgemma_27b_text_it_mcq_json_m_arc/EXPERIMENT.md

Experiment complete.
