{
  "metadata": {
    "config": {
      "backend": {
        "_target_": "cotlab.backends.TransformersBackend",
        "device": "cuda",
        "dtype": "bfloat16",
        "enable_hooks": true,
        "trust_remote_code": true
      },
      "model": {
        "name": "google/medgemma-4b-it",
        "variant": "4b",
        "max_new_tokens": 512,
        "temperature": 0.7,
        "top_p": 0.9
      },
      "prompt": {
        "_target_": "cotlab.prompts.length_matched_strategies.ContrarianMatchedStrategy",
        "name": "contrarian_matched"
      },
      "dataset": {
        "_target_": "cotlab.datasets.PatchingPairsDataset",
        "name": "patching_pairs",
        "path": "data/Patching_Pairs_Data.csv"
      },
      "experiment": {
        "_target_": "cotlab.experiments.AttentionAnalysisExperiment",
        "name": "attention_analysis",
        "description": "Analyze attention patterns at critical layers",
        "target_layers": [
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33
        ],
        "num_samples": 20
      },
      "seed": 42,
      "verbose": true,
      "dry_run": false
    },
    "start_time": "2025-12-26T17:49:26.041082"
  },
  "experiment": "attention_analysis",
  "model": "google/medgemma-4b-it",
  "prompt_strategy": "contrarian_matched",
  "metrics": {
    "num_samples_analyzed": 20,
    "num_layers_analyzed": 9,
    "num_heads": 8,
    "overall_mean_entropy": 1.6711178249782987,
    "most_focused_layer": 28,
    "most_focused_entropy": 1.2432525634765625
  },
  "raw_outputs": [
    {
      "layer": 25,
      "mean_entropy": 1.2455078125,
      "std_entropy": 0.020098334802381348,
      "mean_per_head": [
        0.82890625,
        1.558203125,
        1.43515625,
        1.141015625,
        1.5171875,
        1.42421875,
        0.754296875,
        1.305078125
      ],
      "std_per_head": [
        0.09786384185677952,
        0.061091302300711144,
        0.0716496126450625,
        0.12490780291285099,
        0.1271206826946347,
        0.10174562816928547,
        0.08986837298455239,
        0.052667782027268586
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "\n\n",
          "count": 19
        },
        {
          "token": ":",
          "count": 12
        },
        {
          "token": "Provide",
          "count": 5
        },
        {
          "token": " your",
          "count": 3
        }
      ]
    },
    {
      "layer": 26,
      "mean_entropy": 2.0712890625,
      "std_entropy": 0.05818624571729841,
      "mean_per_head": [
        2.226953125,
        2.63359375,
        1.36875,
        2.322265625,
        1.83359375,
        2.68125,
        1.9375,
        1.56640625
      ],
      "std_per_head": [
        0.14838557891283394,
        0.09612550288392513,
        0.15958549212530254,
        0.1439467700485908,
        0.1403882555796157,
        0.06218671481916375,
        0.030757843257858637,
        0.0932113431519335
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "\n\n",
          "count": 13
        },
        {
          "token": ":",
          "count": 4
        },
        {
          "token": "Provide",
          "count": 4
        },
        {
          "token": " devil",
          "count": 2
        }
      ]
    },
    {
      "layer": 27,
      "mean_entropy": 1.441650390625,
      "std_entropy": 0.030506150204042567,
      "mean_per_head": [
        0.53662109375,
        2.9484375,
        0.9515625,
        0.99453125,
        0.428125,
        0.30048828125,
        3.17421875,
        2.19921875
      ],
      "std_per_head": [
        0.060262294290536096,
        0.18282585421310082,
        0.045694777549655494,
        0.04514043299976475,
        0.028138560099143756,
        0.018115431792219437,
        0.07611075272054203,
        0.07747778789554784
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        }
      ]
    },
    {
      "layer": 28,
      "mean_entropy": 1.2432525634765625,
      "std_entropy": 0.03129075179736766,
      "mean_per_head": [
        2.5765625,
        1.433203125,
        1.25703125,
        0.0853271484375,
        1.7515625,
        2.091796875,
        0.298779296875,
        0.4517578125
      ],
      "std_per_head": [
        0.11287913544473133,
        0.13389893412774756,
        0.04285496297469524,
        0.00803348798035786,
        0.065625,
        0.05556632043600579,
        0.032162096683895594,
        0.02485231647708808
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": " your",
          "count": 12
        },
        {
          "token": ":",
          "count": 8
        }
      ]
    },
    {
      "layer": 29,
      "mean_entropy": 1.596337890625,
      "std_entropy": 0.05706096554350727,
      "mean_per_head": [
        1.796484375,
        1.0283203125,
        1.972265625,
        2.76875,
        1.869140625,
        1.90859375,
        0.2916015625,
        1.135546875
      ],
      "std_per_head": [
        0.14941036045250303,
        0.06470564877881002,
        0.093341394712083,
        0.0639671546576835,
        0.14081746811447746,
        0.13764418931274397,
        0.02793105328828415,
        0.0673542172114848
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        },
        {
          "token": "You",
          "count": 12
        },
        {
          "token": "\n\n",
          "count": 5
        },
        {
          "token": "Provide",
          "count": 3
        }
      ]
    },
    {
      "layer": 30,
      "mean_entropy": 2.470361328125,
      "std_entropy": 0.0758665725326401,
      "mean_per_head": [
        2.34921875,
        2.78046875,
        2.671875,
        2.2421875,
        2.194140625,
        2.71953125,
        2.42265625,
        2.3828125
      ],
      "std_per_head": [
        0.09456352754729226,
        0.07202345402497369,
        0.11385897938897925,
        0.120879346483384,
        0.11851526450175888,
        0.09263332347048497,
        0.10071460975046025,
        0.13170494070554073
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "Provide",
          "count": 12
        },
        {
          "token": " analysis",
          "count": 12
        },
        {
          "token": "You",
          "count": 4
        },
        {
          "token": " lymphoma",
          "count": 2
        }
      ]
    },
    {
      "layer": 31,
      "mean_entropy": 1.6611328125,
      "std_entropy": 0.05177945818013849,
      "mean_per_head": [
        0.40263671875,
        0.34541015625,
        1.341015625,
        2.19453125,
        2.3109375,
        2.4359375,
        1.749609375,
        2.508984375
      ],
      "std_per_head": [
        0.038636717565210775,
        0.03216598828906559,
        0.09511618486381208,
        0.14236981786552408,
        0.05365088972934185,
        0.06089742271845336,
        0.07221704448170026,
        0.2456068471941934
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        }
      ]
    },
    {
      "layer": 32,
      "mean_entropy": 1.464984130859375,
      "std_entropy": 0.05421849191642701,
      "mean_per_head": [
        1.454296875,
        2.14296875,
        1.46484375,
        2.29375,
        0.233349609375,
        1.0765625,
        2.53828125,
        0.5158203125
      ],
      "std_per_head": [
        0.1492632255381307,
        0.230781038422381,
        0.0630590233803815,
        0.053809922992883,
        0.034758594959426466,
        0.0955667076207439,
        0.07989785348923649,
        0.050837183738758396
      ],
      "top_tokens": [
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": "You",
          "count": 20
        },
        {
          "token": " your",
          "count": 15
        },
        {
          "token": ":",
          "count": 4
        },
        {
          "token": " analysis",
          "count": 1
        }
      ]
    },
    {
      "layer": 33,
      "mean_entropy": 1.84554443359375,
      "std_entropy": 0.03927981201489619,
      "mean_per_head": [
        2.97109375,
        1.684765625,
        1.776953125,
        1.898046875,
        1.1033203125,
        2.696875,
        2.2578125,
        0.37548828125
      ],
      "std_per_head": [
        0.07399637739232574,
        0.07233527049387369,
        0.031296352342116085,
        0.0590593480475096,
        0.18268339374741815,
        0.13020416659999787,
        0.04029311549446134,
        0.029113193722195004
      ],
      "top_tokens": [
        {
          "token": ":",
          "count": 20
        },
        {
          "token": "<bos>",
          "count": 20
        },
        {
          "token": " analysis",
          "count": 20
        }
      ]
    }
  ],
  "num_samples": 0,
  "samples": [],
  "end_time": "2025-12-26T17:49:37.394528",
  "duration_seconds": 11.353448
}